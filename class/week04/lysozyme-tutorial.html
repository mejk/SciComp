
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lysozyme solvated in water &#8212; SciComp9502B</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_layouts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/save_state.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://mejk.github.io/CHEM3300G/class/week04/lysozyme-tutorial.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mejk.github.io/CHEM3300G/class/week04/lysozyme-tutorial.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Lysozyme solvated in water" />
<meta property="og:description" content="Lysozyme solvated in water  Topology  Step 1: The pdb file: Perform the checks before pdb2gmx  The first step is to select the molecule, in our case a protein, " />
<meta property="og:image"       content="https://mejk.github.io/CHEM3300G/_static/logo-scicomp.svg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo-scicomp.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SciComp9502B</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/syllabus.html">
   Scientific Computing - SciComp9505B
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/Linux-basics.html">
   1. Linux - the basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/linux-basic-commands-2.html">
   2. Linux: Some basic &amp; useful commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-intro.html">
   3. Brief introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week01/hpc-intro.html">
   4. Background on computers, computing and High Performance Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week03/random_numbers.html">
   5. Random numbers
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/coding-notes-general.html">
   1. On computation and codes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Installation instructions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/install-wsl.html">
   1. Installation of tools: WSL2/Linux etc.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-installation.html">
   2. Installation of Python and Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/python-virtual-environment.html">
   3. Python virtual environments
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  How-tos
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/jupyter-intro.html">
   1. Jupyter Notebook / Jupyter Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/vi-editor.html">
   2. The
   <code class="docutils literal notranslate">
    <span class="pre">
     vi
    </span>
   </code>
   editor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/editing-ascii.html">
   3. Editing ASCII files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/helpful-software.html">
   4. Helpful software
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More on computers / help
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff/blob/master/ssh-keys.md">
   ssh keys, aliases and connecting using ssh keys
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff">
   Random notes on computers, installation, dual boot, vnc, etc.
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/class/week04/lysozyme-tutorial.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Lysozyme solvated in water
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#topology">
     Topology
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-the-pdb-file-perform-the-checks-before-pdb2gmx">
       Step 1: The pdb file: Perform the checks before pdb2gmx
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-2-process-the-pdb-file-using-pdb2gmx">
       Step 1.2: Process the pdb file using pdb2gmx
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-3-examine-the-screen-messages">
       Step 1.3: Examine the screen messages:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-4-check-that-you-got-the-3-files">
       Step 1.4: Check that you got the 3 files:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-simulation-box-geometry">
     Set simulation box geometry
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-1-put-the-molecule-in-a-simulation-box">
       Step 2.1. Put the molecule in a simulation box.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solvate-the-molecule">
     Solvate the molecule
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-1-lets-add-water-molecules">
       Step 3.1. Let’s add water molecules
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-ions">
     Add ions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-1-pre-processing-by-grompp-the-gromacs-pre-processor">
       Step 4.1 Pre-processing by grompp (the Gromacs pre-processor).
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-2-grommp-messages">
       Step 4.2 grommp messages
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-3-add-ions-to-neutralize-the-system-no-salt-is-added-this-time-using-genion">
       Step 4.3 Add ions to neutralize the system (no salt is added this time) using genion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-minimization">
     5. Energy minimization
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-5-1-if-you-dont-have-one-prepare-an-mdp-file-for-energy-minimization">
       Step 5.1. If you don’t have one, prepare an .mdp file for energy minimization.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-gpu-verlet-only">
   For GPU: verlet only
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimal-mdp-file-energy-minimzation">
     5.1.1 Minimal .mdp file energy minimzation:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-5-3-run-mdrun-for-energy-minimization">
     Step 5.3. Run mdrun for energy minimization.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equilibration">
     6. Equilibration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-6-1-prepare-the-mdp-file">
       Step 6.1. Prepare the .mdp file.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-6-2-run-grompp-to-combine-structure-topology-and-parameters-for-mdrun">
       Step 6.2. Run grompp to combine structure, topology and parameters for mdrun
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lysozyme-solvated-in-water">
<h1>Lysozyme solvated in water<a class="headerlink" href="#lysozyme-solvated-in-water" title="Permalink to this headline">¶</a></h1>
<div class="section" id="topology">
<h2>Topology<a class="headerlink" href="#topology" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1-the-pdb-file-perform-the-checks-before-pdb2gmx">
<h3>Step 1: The pdb file: Perform the checks before pdb2gmx<a class="headerlink" href="#step-1-the-pdb-file-perform-the-checks-before-pdb2gmx" title="Permalink to this headline">¶</a></h3>
<p>The first step is to select the molecule, in our case a protein, we wish to model. For that we need the so-called topology. Topology provides the connectivity, that is, how the different atoms in the molecule are connected. The molecule we get from the PDB (Protein Data Bank) database such as we did last time (when we uploaded the pdb file for ubiquitin, 1UBQ.pdb). For the following (and also for all the other file editions) you will need a basic text editor like emacs, vi, notepad, or such. Do not use MS Office or similar. All the files must be in plain text format. Let’s get started:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>• Download the pdb file 1AKI (1AKI.pdb) from www.rcsb.org 
    ◦ 1AKI is hen white lysozyme. For your own information, check what is the biological importance &amp; functions of this molecule.
• When you have the file, it is good to make a backup copy of it so that you will have the original available in case something goes wrong in the following steps.
• Now that we have the molecule, we must perform some basic checks to see if the file is complete or if it is missing something. Why would the file be missin some atoms? Typically, the structures in the pdb database have been obtained using (x-ray) scattering. While scattering has very high resolution, it cannot always resolve all the atoms due to reasons such as lack of contrast (question: what is contrast in scattering?) or the presence of other molecules such as lipid (getting structures of proteins embedded in lipid membranes is extremely difficult). In addition, the structure may have some left-over water molecules, called crystal waterm, in it (as we will notice below):
    ◦ Let&#39;s see if any atoms are missing: Find the comment ‘MISSING’ in the pdb file.
        ▪ In the case of 1AKI.pdb, nothing is missing (but you should still check the contents of the file 1AKI.pdb and also the file we uploaded last time, 1UBQ.pdb). If you open the file and search for ‘MISSING’, no such line exists in 1AKI.pdb. This means: All good, no missing groups. That is not always the case. Question: what should we do if there are missing atoms (as there often are)
    ◦ Find if there are crystal waters. In this case there are some: There are 78 [line FORMUL   2  HOH   *78(H2 O)]. Remove them. 
• Use your favourite molecular visualization software (VMD, pymol, etc.) to 1AKI before and after removal of crystal waters. For that, use a proper representation (such as van der Waals or CPK)  for the molecule(s) so ensure that the crystal waters have been removed.
• IMPORTANT: The PDB format is strict. Do not change the format in any way, that is, do not change the number of empty space or labels unless you know exatcly what you are doing. 
</pre></div>
</div>
</div>
<div class="section" id="step-1-2-process-the-pdb-file-using-pdb2gmx">
<h3>Step 1.2: Process the pdb file using pdb2gmx<a class="headerlink" href="#step-1-2-process-the-pdb-file-using-pdb2gmx" title="Permalink to this headline">¶</a></h3>
<p>Now that we have cleaned up and verified the contents of the 1AKI.pdb file, we must convert it to a Gromacs friendly format using the module pdb2gmx. As the name suggested, this converts from the pdb to gromacs format (produces a .gro file). Two other things are done in this process: As discussed 1) pdb2gmx will ask you to select a force field and 2) we will specify a water model (later, we will have to hydrate our molecule).</p>
<p>Let’s run pdb2gmx:</p>
<p>gmx pdb2gmx -f 1AKI.pdb -o 1AKI_processed.gro -water spce</p>
<p>-water  spce: SPC/E water was chosen.</p>
<p>As described above, pdb2gmx prompts you choose a force field. Let’s pick OPLS/AA (number 15). This is also what is done in Justin Lemkuhl’s tutorial (see the links at the very beginning).</p>
</div>
<div class="section" id="step-1-3-examine-the-screen-messages">
<h3>Step 1.3: Examine the screen messages:<a class="headerlink" href="#step-1-3-examine-the-screen-messages" title="Permalink to this headline">¶</a></h3>
<p>The execution of the above command will provide lots of info on the screen. Take a look and see that you don’t get any error messages or serious warnings. There shouldn’t be any, but that is not guaranteed. As said above, pick the OPLS/AA force field, OPLS = Optimized Parameters for Liquid Simulations, AA=All Atom.</p>
</div>
<div class="section" id="step-1-4-check-that-you-got-the-3-files">
<h3>Step 1.4: Check that you got the 3 files:<a class="headerlink" href="#step-1-4-check-that-you-got-the-3-files" title="Permalink to this headline">¶</a></h3>
<p>Running pdb2gmx generates 3 files:</p>
<p>1AKI_processed.gro	# Structure/coordinates in Gromacs format. Has all the atoms.
topol.top		# System topology
posre.itp		# Position restraints of heavy atoms</p>
<p>All there? You should check what those files contain (but don’t mess them up!). Then it is the time to set up the simulation box and add the solvent. But first a side note regarding the above files.</p>
<p>Side note to 1.2:</p>
<p>topol.top (default name unless otherwise defined):
This file, generated by pdb2gmx, has all the information that is needed to define a molecule for a simulation. That is, interaction parameters, charges, atom types, masses, the force field, exclusions, solvent, ions, restraints, etc.. See the Gromacs manual for more.</p>
<p>Important 1: This file gets modified when grompp is used in the following steps -&gt; you cannot use your topol.top file from any of the previous steps.</p>
<p>Important 2: Grompp also modifies the .gro file at the same time it modifies topol.top. The records in the two files (order of molecules) MUST match.</p>
<p>posres.itp:
This file includes the force constants that are used to keep (restrain) the atoms in their places during equilibration (question you should answer: what does that mean and why is this done?): This means that the restrained atoms can move but there is a very large energy penalty on that due to the restraints. Information about position restraints is added in topol.top.</p>
<p>Important: whether or not restraints are used is defined by the preprocessing directive -DPOSRES in the .mdp file. The .mdp file contains all the simulation parameters (we will use it shortly).</p>
<p>1AKI_processed.gro:
Strictly speaking, it is not necessary to use the .gro format, but it is very convenient. If you want to use some other format, see the Gromacs manual.</p>
<p>Important: This file gets modified by grompp.</p>
</div>
</div>
<div class="section" id="set-simulation-box-geometry">
<h2>Set simulation box geometry<a class="headerlink" href="#set-simulation-box-geometry" title="Permalink to this headline">¶</a></h2>
<p>The previous step provided us with the topology, user friendly .gro file and the restraints, and we also chose a force field. To be able to run a simulation, we have to define the space in which we simulate the molecule. For that we we need to define boundary conditions (question you should answer: what kind of boundary conditions are there and why we our choices). Let’s go through the necessary steps:</p>
<div class="section" id="step-2-1-put-the-molecule-in-a-simulation-box">
<h3>Step 2.1. Put the molecule in a simulation box.<a class="headerlink" href="#step-2-1-put-the-molecule-in-a-simulation-box" title="Permalink to this headline">¶</a></h3>
<p>We need to define the space in which we simulate the molecule. It is called the simulation box. This also means setting the dimensions of the simulation box &amp; defining geometry for the simulation box. Below, we will choose cubic for simplicity. Since we do not need any particular dimensions (as long as the minimum image convention is satisfied; question: find out what minimum image convention means), it is ok to use the switch -d that defines the minimum distance from the box edge. That is done by executing the following command:</p>
<p>gmx editconf -f 1AKI_processed.gro -o 1AKI_newbox.gro -c -d 1.0 -bt cubic</p>
<p>-c: centers (the molecule that was given in the pdb file).
-d: the minimum distance from the box edge.
Must be large enough to satisfy the minimum image convention when periodic boundaries are used (almost always). Pay attention to the cutoff distances in the .mdp file (later)!
-bt: box type. We chose cubic</p>
<p>Running the above prints lots of info on the screen such as box size, volume, angles (you can see if actually is cubic), the number of atoms read by it and if velocities were present in the input file (in this case not, velocities will be initialized later). Check all tha information so that you understand what is going on. In particular: pay attention to possible error and warning messages.</p>
<p>Now that we have our molecule, simulation geometry and boundary conditions, we are ready to fill the simulation box with water – after all, biological molecules function under aqueous conditions (question: is it possible to simulate, or does it make sense to simulate, proteins, DNA etc without water).</p>
</div>
</div>
<div class="section" id="solvate-the-molecule">
<h2>Solvate the molecule<a class="headerlink" href="#solvate-the-molecule" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-3-1-lets-add-water-molecules">
<h3>Step 3.1. Let’s add water molecules<a class="headerlink" href="#step-3-1-lets-add-water-molecules" title="Permalink to this headline">¶</a></h3>
<p>We need to add the solvent, that is, water molecules, in the simulation box. This is done using the module solvate and the 1AKI_newbox.gro file we created in the previous step:</p>
<p>gmx solvate -cp 1AKI_newbox.gro -cs spc216.gro -o 1AKI_solv.gro -p topol.top</p>
<p>-cp: configuration of the protein as defined by the .gro file create in Step 2.1.
-cs: configuration of the solvent.
-o: output file. Solvated protein.
-p: topology file. This is needed in order to generate the solvated output file 1AKI_solv.gro. the topology file itself gets also updated: The number of solvent molecules is written in it (check it). This means that you cannot use the same topol.top for other systems.</p>
<p>Important: You may wonder why the file spc216.gro. Here’s the answer: It describes a generic 3-point water model (question: what kind of water models are there? Why so many?). It can be used for all three point models (SPC, SPC/E, TIP3P).</p>
<p>Again, info is printed on screen. It includes:
• Number of residues.
• Number of atoms.
• Number of atoms removed due to various overlaps (sol-sol, solute-sol).
Please check this info and pay attention to possible error and warning messages.</p>
<p>In this case it should be something like (the exact number will vary a bit; question: why aren’t the numbers always the same?):
• 10,644 solute molecules equalling to 31,932 atoms (3 per water)
• 33,892 atoms in total
• Density 997.935 g/l and volume 344.484 nm3. Notice the units, we are using the Gromacs unit conventions.</p>
<p>If the number of atoms (about 32,000) is too much for your computer, change</p>
<p>gmx editconf -f 1AKI_processed.gro -o 1AKI_newbox.gro -c -d 1.0 -bt cubic</p>
<p>to</p>
<p>gmx editconf -f 1AKI_processed.gro -o 1AKI_newbox.gro -c -d 0.6 -bt cubic</p>
<p>This means that the minimum distance to the box edge is changed to 0.6 nm. This is large enough for a cutoff (that is defined in the .mdp file shortly) of 1.0 nm but not 1.2nm since the minimum distance to the box edges is only 0.6. In practise that means that the minimum linear size for the box is 1.2 nm.</p>
<p>Visualize the system using VMD! You should vary the representations for water (even turning waters off) and the hen lysozyme.</p>
</div>
</div>
<div class="section" id="add-ions">
<h2>Add ions<a class="headerlink" href="#add-ions" title="Permalink to this headline">¶</a></h2>
<p>So far we have our hen lysozyme and water in a cubic simulation box. Here, we add some ions. Why? There are several reasons. One very important one is technical: Electrostatic interactions are of long range similar to gravity. Due this special character, we must treat the long-range part very carefully. There are several methods, but we use the so-called PME, or Particle-Mesh Ewald, algorithm. Its details are not important at this time. What you should know at this time is: 1) this method is used in most production level simulations and 2) to use this method, it is imperative that the system is charge neutral, that is the sum of all charges must be precisely zero. This is the main reason for adding atoms here since the hen lysozyme molecule has a net charge and it is must be neutralized. The second reason for adding ions is that ions are virtually always present in biological and other real systems.</p>
<p>At this stage we need an additional file, the .mdp file that contains simulations parameters. The minimal file needed is given on the next page and you should create this file and call it ions.mdp. This file must be in ASCII (text only) format. Unlike in the case of the .pdb file, the empty spaces are not important.</p>
<p>The other new thing is that we will use the Gromacs Pre-Processor, grompp.</p>
<p>Proceed as described above in Section 4:</p>
<div class="section" id="step-4-1-pre-processing-by-grompp-the-gromacs-pre-processor">
<h3>Step 4.1 Pre-processing by grompp (the Gromacs pre-processor).<a class="headerlink" href="#step-4-1-pre-processing-by-grompp-the-gromacs-pre-processor" title="Permalink to this headline">¶</a></h3>
<p>grompp generates a run input file (.tpr).
This is the first time .tpr file appears! The .tpr file is in binary format. This is in contrast to the .gro and .top files which are in ASCII format.</p>
<p>Technical question: Is .tpr binary compatible between different architectures?</p>
<p>grommp:
Note: the grompp pre-processor (also used below) always requires a .mdp file. The same .mdp file CANNOT be used for the different purposes.
What matters in the .mdp file used at this particular step:</p>
<p>gmx grompp -f ions.mdp -c 1AKI_solv.gro -p topol.top -o ions.tpr</p>
<p>-f: .mdp file. This has the control parameters.
-c: .gro file. Contains the structure of the system (protein with solvent at this time).
-p: Topology of the system is in .top file. The switch -p automatically modifies the topol.top file. If you don’t use -p you must edit topol.top yourself because the ions must be added into it.
-o: output to ions.tpr. Combines info from ions.mdp, 1AKI_solv.gro and topol.top
-o: out</p>
<p>Note: While .gro is an ASCII file, .tpr is a binary file.</p>
<p>Task: Go to the Gromacs manual and find out what the parameters in the file below are.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
ions.mdp<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">;=======================================================================
; ions.mdp
;
integrator   = steep         ; Algorithm (steep = steepest descent minimization)
emtol        = 1000.0        ; Stop minimization when F_max  &lt; 1000.0 kJ/mol/nm
emstep      	= 0.01      	   ; Energy step size
nsteps       = 50000         ; Maximum number of (minimization) steps to perform
;
; Parameters for performing neighbor search &amp; calculation of interactions
;
nstlist             = 1             ; Neighbor list &amp; long range forces update frq
cutoff-scheme   = Verlet
ns_type             = grid              ; Method for neighbor list (simple, grid)
coulombtype         = PME               ; Method for long range electrostatics
rcoulomb            = 1.0               ; Real space electrostatic cut-off
rvdw                = 1.0               ; Short-range Van der Waals cut-off
pbc                 = xyz               ; Periodic Boundary Conditions</p>
</div>
</details></div>
<div class="section" id="step-4-2-grommp-messages">
<h3>Step 4.2 grommp messages<a class="headerlink" href="#step-4-2-grommp-messages" title="Permalink to this headline">¶</a></h3>
<p>It gets more involved.  A lot of information gets printed on screen. Take a look and see that there are no error messages. There is one particularly important message: One of the notes will tell if the system has non-zero charge. In this case it does, the message is:</p>
<p>NOTE 2 [file topol.top, line 18409]:
System has non-zero total charge: 8.000000
Total charge should normally be an integer.</p>
<p>This means that to neutralize (MUST be done) the system, you need to add 8 ions of valence one (-1 to be precise). This will be done in the next step using genion.</p>
<p>Now that we have all the info combined in the file ions.tpr, let’s process it using genion.</p>
</div>
<div class="section" id="step-4-3-add-ions-to-neutralize-the-system-no-salt-is-added-this-time-using-genion">
<h3>Step 4.3 Add ions to neutralize the system (no salt is added this time) using genion<a class="headerlink" href="#step-4-3-add-ions-to-neutralize-the-system-no-salt-is-added-this-time-using-genion" title="Permalink to this headline">¶</a></h3>
<p>The .tpr is the run input file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gmx genion -s ions.tpr -o 1AKI_solv_ions.gro -p topol.top -pname NA -nname CL -nn 8
</pre></div>
</div>
<p>-s: specifies the run input (.tpr) file.
-o: specifies the structure output file (.gro).<br />
-p: topology (.top) file. This will be changed: Waters will be removed and ions added.
-pname: Name of positive ions. MUST be in capitals. No residue names allowed!
-nname: Name of negative ions. MUST be in capitals. No residue names allowed!
-nn: Number of negative ions.</p>
<p>When genion is executed it will ask prompt you to</p>
<p>“Select a continuous group of solvent molecules”.</p>
<p>Select the SOL group (option number 13 in Gromacs 5.1). That choice asks genion to replace molecules in the SOL group by ions. If you pick a protein group, parts of the protein will be replaced by ions. Figure shows the system before and after addition of ions.</p>
<p>Pre-processing &amp; setup is now completed. The next step is energy minimization.</p>
<p>Next: Energy minimization, equilibration &amp; production runs</p>
<p>We have two steps left before production simulation(s) can start:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Energy minimization. This is typically done by using the method of steepest descents or the conjugate gradient method
2. Equlibration. Typically done by running short NVT and possibly also NpT simulations.
</pre></div>
</div>
<p>The system is ready for production simulations after the above steps.</p>
</div>
</div>
<div class="section" id="energy-minimization">
<h2>5. Energy minimization<a class="headerlink" href="#energy-minimization" title="Permalink to this headline">¶</a></h2>
<p>Done by: mdrun
Syntax: gmx mdrun {options}
Pre-requisites: grompp.</p>
<p>Why:
Putting the molecules and ions in the system is more or less a random process. There may be steric problems (partial overlaps, too tight packing, too loose packing), energetically unfavourable conformations and so on. Thus, the structure needs to be relaxed and that is done by energy minimization. Gromacs has three minimization routines:</p>
<div class="section" id="step-5-1-if-you-dont-have-one-prepare-an-mdp-file-for-energy-minimization">
<h3>Step 5.1. If you don’t have one, prepare an .mdp file for energy minimization.<a class="headerlink" href="#step-5-1-if-you-dont-have-one-prepare-an-mdp-file-for-energy-minimization" title="Permalink to this headline">¶</a></h3>
<p>In the .mdp file, the method of energy minimization is in the entry “integrator”. These are the current options:</p>
<p>integrator steep  # steepest descents
integrator cg	    # conjugate gradient
integrator l-bfgs # quasi-Newtonian Broyden-Fletcher-Goldfarb-Shannon. Not parallel.</p>
<p>At this time, the best options are steepest descents and conjugate gradient.</p>
<p>Steepest descents needs (NOTE: I THINK EMTOLD AND NSTEPS ARE COMPLEMENTARY):
maximum step size: 	emstep 	# in nanometers. Typical: 0.01
tolerance: 		emtol		# kJ mol-1 nm-1. Typical: 1000. Stops
# when max force &lt;emtol
max number of steps:	nsteps		# Typical: 50,000</p>
<p>Conjugate gradient needs:
tolerance:		emtol		# kJ mol-1 nm-1. Typical</p>
<p>Note: emtol gives the maximum force. It is well possible that after minimization F_max &gt; emtol. In that case you must figure why that is since it is quite likely that the simulation will not be stable.</p>
<p>In both cases parameters for interactions &amp; finding neighbors must be specified:</p>
<p>nstlist   	     	# neighbor list upd8 frequency. Typical: 1
cutoff-scheme   	# group or verlet based pair list.</p>
</div>
</div>
</div>
<div class="section" id="for-gpu-verlet-only">
<h1>For GPU: verlet only<a class="headerlink" href="#for-gpu-verlet-only" title="Permalink to this headline">¶</a></h1>
<p>ns_type  		# How to compute neighbor list. Typical: grid. Faster
coulombtype    	# Long-range electrostatics. Typical: PME
rcoulomb    	   	# Short-range electrostatic cut-off. Typical: 1.0.
rvdw 	 	   	# Van der Waals cut-off. Typical: 1.0
pbc   	     		# Periodic Boundary Conditions. Typical: xyz</p>
<p>In practise, the choice is between steepest descents and conjugate gradient. Both are deterministic methods, that is, they will stop when they find the first local minimum. Due that, sometimes it may be good to run minimization again after short equilibration (next step).</p>
<div class="section" id="minimal-mdp-file-energy-minimzation">
<h2>5.1.1 Minimal .mdp file energy minimzation:<a class="headerlink" href="#minimal-mdp-file-energy-minimzation" title="Permalink to this headline">¶</a></h2>
<p>Typical .mdp file for performing energy minimization looks like this. Let’s call this “e-min.mdp”:</p>
<p>;==================================================================================
integrator  	= steep   	 ; Algorithm (steep = steepest descent minimization)
emtol   	= 1000.0 	 ; Stop when max force &lt; 1000.0 kJ/mol/nm
emstep  	= 0.01		 ; Energy step size
nsteps   	= 50000     	 ; Maximum number of (minimization) steps to perform
;
;== Interactions + finding neighbours ==============
;
nstlist   	 = 1   		; Neighbor list upd8 frequency. shouldnt matter w/ Verlet
cutoff-scheme  = Verlet	; Works for GPU too (‘group’ does not)
ns_type   	 = grid   	; How to determine neighbor list (simple or grid)
coulombtype    = PME   	; Long-range electrostatics
rcoulomb    	 = 1.0   	; Short-range (real space) electrostatic cut-off
rvdw   	 	= 1.0   	; Van der Waals cut-off
pbc   	     	 = xyz    	; Periodic Boundary Conditions
;==================================================================================</p>
<p>Not that intimidating. But  there are a lot of options. The full catalogue is available here:</p>
<p>http://manual.gromacs.org/online/mdp_opt.html</p>
</div>
<div class="section" id="step-5-3-run-mdrun-for-energy-minimization">
<h2>Step 5.3. Run mdrun for energy minimization.<a class="headerlink" href="#step-5-3-run-mdrun-for-energy-minimization" title="Permalink to this headline">¶</a></h2>
<p>With all the necessary steps taken above, the next is very simple:</p>
<p>gmx mdrun -v -deffnm em</p>
<p>The syntax:
mdrun 		# obvious
-v		# verbose output so that you can follow what is happening
-deffnm	# file names for input and output (all files will be named using this)</p>
<p>The following files will be generated by mdrun:
• em.log		# log file
• em.edr		# energy. Binary file
• em.trr		# Trajectory. Full precision, binary format.
• em.gro		# Energy minimized structure</p>
<p>How do you know it worked out?</p>
<p>Let’s plot: # to do: plot and find out F_max &amp; energy automatically
Next, we need to examine how the potential energy behaved. First, extract the data from the .edr file and then plot the resulting .xvg file with xmgrace (gnuplot would work as well without any modifications).</p>
<p>gmx energy -f em.edr -o potential.xvg
xmgrace potential.xvg</p>
<p>In the above, tunning the energy module gives a prompt asking what do you want (here, potential energy). Plots are shown below (plotted with xmgrace)</p>
</div>
<div class="section" id="equilibration">
<h2>6. Equilibration<a class="headerlink" href="#equilibration" title="Permalink to this headline">¶</a></h2>
<p>Done by module mdrun.
Needs: grompp
Files modified:
Important: This step uses the posre.top, the position restraint file that was created earlier.
Typical run times: 20-100 ps.</p>
<p>Note: Depending on the system, equilibration may need several steps. For example, short NVT simulation and then a short NpT simulation. Or it may be necessary to return the energy minimization after NVT.</p>
<p>The energy minimization procedure is just that, deterministic minimization. There is no dynamics. During equilibration, we will run NVT molecular dynamics.</p>
<p>Important: In the energy minimization procedure there was no temperature. Here, since we have an NVT ensemble, the system must be brought to equilibrium at some chosen temperature.</p>
<div class="section" id="step-6-1-prepare-the-mdp-file">
<h3>Step 6.1. Prepare the .mdp file.<a class="headerlink" href="#step-6-1-prepare-the-mdp-file" title="Permalink to this headline">¶</a></h3>
<p>We must prepare a .mdp file for the NVT MD simulation. Minimal .mdp file could look like this:</p>
<p>GPU NOTE: With GPU, rcoulomb and grid spacing are auto-tuned. This can be turned off by using:</p>
<p>mdrun -notunepme</p>
<p>If no GPU is used, then there’s no need to care about this issue.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
.mdp file<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">; ####### 	Preprocessing. OK/
;==================================================================
; - Equilibration:	Use -DPOSRES. Requires posres.top created earlier
;                                      Use for both NVT and NpT equilibration.
; - Production: 		-DFLEXIBLE if flexible water is used
; - Title: 		It may be nice to give a descriptive title
;
title	= Test title
; define = 	-DFLEXIBLE	; # flexible water instead of rigid. Pay attention to constraints!
define =	-DPOSRES	; Position restraints used. posres.top is used here!</p>
<p class="card-text">; ########	Basic run control. OK
;============================
; - dt: 	no constraints: 0.01, with constraints: 0.02
;
integrator 	= md 		; standard leap-frog. others are available incl. vv
dt		= 0.001	; time step in ps. This would be 1 fs. 2 fs is std.
nsteps		= 20000 	; # of steps. This would mean 20 ps for MD.
nstcomm	= 100		; frequency (in steps) to remove com motion; CHECK!!</p>
<p class="card-text">;######### 	Neighborlists and related. OK
;========================================
;
; CHECK nstlist vs Verlet vs verlet-buffer-tolerance
;
cutoff-scheme = Verlet	; Verlet is needed for GPU
; nstlist 	= 10		; neighbor list update frq. Verlet: 20-40, group &lt;10
ns_type	= simple	; method for constructing neighbor lists. Grid is faster
pbc		= xyz		; Full periodic boundary conditions
; verlet-buffer-tolerance = 0.005 ; max error for pair interactions/particle Verlet
; rlist		= 0.9		; w/ Verlet: ignored &amp; auto-determined by the previous</p>
<p class="card-text">;#########	Basic output control. OK
;=====================================
;
; tinit	= 		; starting time
; tinit-step	=		; for restarts
nstxout	= 500		; coordinates out every 0.5 ps. Standard: 1.0 ps
nstvout	= 500		; frq for writing out velocities
; nstfout	=		; frq for writing out forces
nstenergy	= 500		; frq for writing out energies
nstlog		= 500		; frq for updating the log file
; energygrps	=		; groups to write to energy file</p>
<p class="card-text">; ########   Electrostatics. OK
; =============================
;
coulombtype	= pme		; you really do want to use PME
rcoulomb	= 0.9		; Coulomb cutoff
pme_order	= 4		; interpolation order needed by PME: 4=cubic
fourierspacing = 0.12	; FFT grid spacing used by PME.</p>
<p class="card-text">; ewald_rtol	= 1e-5		; does this matter for PME? Does. Needed?
; ewald-geometry =	3d	; 3dc is quasiperiodic
; epsilon-surface = 0	; Dipole correction: be careful</p>
<p class="card-text">;######### Van der Waals interactions. OK
;========================================
;
; -rvdw MUST be chosen to be commensurate with rcoulomb
;
; vdwtype	=		;
; vdwmodifier = none	;
; rvdw-switch	 =		;
rvdw		= 0.9		; vdW cutoff. NOTE:
dispcorr	= EnerPres	; options: no, EnerPres, Ener</p>
<p class="card-text">;####### TEMPERATURE COUPLING. OK
;===============================
;
tcoupl		= v-rescale	; v-rescale is currently THE choice over NH and Berendsen
ld-seed	= -1		; seed for LD, v-rescale, BD. Is this needed??
;
;### Only one group coupled
; tc-grps	= system	; groups to couple separately to t-bath
; tau_t		= 0.1		; same value for v-rescale &amp; Berendesen
; ref_t		= 300		; temperature in Kelvin
;
;#### Couple different groups (usually the better way):
;
tc-grps	= Protein Non-Protein ; couple separately
tau_t		= 0.1 0.1	; with the above
ref_t		= 300 300	; temperatures in Kelvin</p>
<p class="card-text">;####### PRESSURE COUPLING. OK
;==============================
;
;## If NVT, then:
;
pcoulp		= no		; This for NVT
;
;## If NpT AND if Berendsen, then:
;
; pcoupl		= berendsen	; barostat
; pcoupltype	= isotropic	; semiisotropic for membranes. two values needed
; compressibility = 4.5e-5	;
; tau_p		= 1.0		;<br />
; ref_p		= 1.0		; pressure in bars
;
;## If NpT AND Parrinello-Raman, then:
;
; check when refcoord_scaling should be used
;
; pcoupl		= Parrinello-Rahman	; barostat
; refcoord_scaling	= com	; scale com of the ref coords w/ the scaling matrix
; pcoupltype	= isotropic	; semiisotropic for membranes. two values needed
; compressibility = 4.5e-5	;
; tau_p		= 2.0		; time constant (different from Berendsen)
; ref_p		= 1.0		; pressure in bars</p>
<p class="card-text">;######### Generate velocities. OK
;=================================
;
; NOTE: gen_vel = no if the run is a continuation!
;
gen_vel	= yes		; generate velocities from a Maxwell distribution
gen-seed	= -1		; random seed for random number generation
gen_temp	= 300		; temperature for the above Maxwell distribution
;
;######### Constraints. OK
;==========================
; -Check your preprocessing options. SHould be chosen to be compatible
; - Q: Does -DPOSRES take care of everything &amp; the below is only needed in full runs?
;
; constraints	= all-bonds	; all bonds constrained. Must be used in initial equilibration
; constraint-algorithm = LINCS ;
; lincs-iter	= 1		; accuracy of LINCS
; lincs-order	= 4		; for higher accuracy, use 6</p>
<p class="card-text">;######### Are we continuing a previous simulation
;================================================
;
; This is also needed when running back-to-back equilibration runs! (NVT-&gt; NpT)
; IMPORTANT: You may need to set gen_vel=no above.
;
continuation	= yes ; restarting a previous run</p>
</div>
</details><p>The above lists many other options than what we need in a minimal equilibration run.</p>
<p>QUESTIONS:
• Relation between -DPOSRES and the entries for constraints?</p>
</div>
<div class="section" id="step-6-2-run-grompp-to-combine-structure-topology-and-parameters-for-mdrun">
<h3>Step 6.2. Run grompp to combine structure, topology and parameters for mdrun<a class="headerlink" href="#step-6-2-run-grompp-to-combine-structure-topology-and-parameters-for-mdrun" title="Permalink to this headline">¶</a></h3>
<p>Let’s grompp:</p>
<p>gmx grompp -f nvt.mdp -c em.gro -p topol.top -o nvt.tpr</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-f nvt.mdp	; input, not modified. Uses posres.top
-c em.gro	; the structure for energy minimization as input. not modified
-p topol.top	; topology
-o nvt.tpr	; trajectory. Output. Modified	
</pre></div>
</div>
<p>Step 6.3 Start the equilibration run using mdrun. NVT run.</p>
<p>Let’s finally run an MD simulation!</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gmx mdrun -deffnm nvt
</pre></div>
</div>
<p>mdrun 		# obvious
-deffnm	# file names for input and output (all files will be named using this)</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "firasm/jupyterbook_course_template",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./class/week04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Karttunen<br/>
        
          <div class="extra_footer">
            <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>