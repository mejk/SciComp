
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generating random numbers &#8212; SciComp9502B</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_layouts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/save_state.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://mejk.github.io/CHEM3300G/class/week03/SciComp-random_numbers.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mejk.github.io/CHEM3300G/class/week03/SciComp-random_numbers.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Generating random numbers" />
<meta property="og:description" content="Generating random numbers  &lt;blockquote&gt; &#34;The generation of random numbers is too important to be left to chance.&#34; &lt;br&gt;- Robert R. Coveyou, Oak Ridge National La" />
<meta property="og:image"       content="https://mejk.github.io/CHEM3300G/_static/logo-scicomp.svg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo-scicomp.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SciComp9502B</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/syllabus.html">
   Scientific Computing - SciComp9505B
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/Linux-basics.html">
   1. Linux - the basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/linux-basic-commands-2.html">
   2. Linux: Some basic &amp; useful commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-intro.html">
   3. Brief introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week01/hpc-intro.html">
   4. Background on computers, computing and High Performance Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_numbers.html">
   5. Random numbers
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/coding-notes-general.html">
   1. On computation and codes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Installation instructions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/install-wsl.html">
   1. Installation of tools: WSL2/Linux etc.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-installation.html">
   2. Installation of Python and Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/python-virtual-environment.html">
   3. Python virtual environments
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  How-tos
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/jupyter-intro.html">
   1. Jupyter Notebook / Jupyter Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/vi-editor.html">
   2. The
   <code class="docutils literal notranslate">
    <span class="pre">
     vi
    </span>
   </code>
   editor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/editing-ascii.html">
   3. Editing ASCII files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/helpful-software.html">
   4. Helpful software
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More on computers / help
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff/blob/master/ssh-keys.md">
   ssh keys, aliases and connecting using ssh keys
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff">
   Random notes on computers, installation, dual boot, vnc, etc.
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/class/week03/SciComp-random_numbers.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/firasm/jupyterbook_course_template/master?urlpath=lab/tree/class/week03/SciComp-random_numbers.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#historical-tidbits">
   Historical tidbits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-numbers-vs-pseudo-random-numbers">
   Random numbers vs Pseudo-random numbers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requirements-for-a-good-random-number-generator">
   Requirements for a good Random Number Generator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uniform-random-numbers">
   Uniform Random Numbers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-congruential-generator-lcg">
     Linear Congruential Generator (LCG)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fibonacci-method">
     Fibonacci Method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagged-fibonacci-generator-lfg">
     Lagged Fibonacci Generator (LFG)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#few-words-on-implementation">
     Few words on implementation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-produce-different-distributions">
     How to produce different distributions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gaussian-distribution-the-box-muller-algorithm">
       Gaussian distribution: The Box-Müller algorithm
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-test-random-number-generators">
     How to test Random Number Generators
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-numbers-using-python">
   Random numbers using Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Uniform random numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-random-numbers">
     Gaussian random numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integer-s-within-given-limits">
     Integer(s) within given limits
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#role-of-random-numbers-in-parallel-stochastic-simulations">
   Role of random numbers in parallel stochastic simulations
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="generating-random-numbers">
<h1>Generating random numbers<a class="headerlink" href="#generating-random-numbers" title="Permalink to this headline">¶</a></h1>
<blockquote>
"The generation of random numbers is too important to be left to chance."
<br>- Robert R. Coveyou, Oak Ridge National Laboratory
</blockquote>
<p>Almost all kinds of simulations in physics, chemistry, engineering, economics and social science use random numbers somewhere during the process. The use of random numbers is extremely common in practical applications and modelling of physical phenomena ranging from radioactive decay to the behavior of stock markets.</p>
<p>A precise mathematical definition of random numbers is difficult to give but let us start with an informal one, which contains the most important properties we demand from random numbers. First, we demand that the random numbers are evenly distributed in interval (0,1); as the preceding indicates, random numbers are assumed to be real. This is also how your computer’s intrinsic RNG produces random numbers. The random numbers should be random. How can we define random? Intuitively, an arbitrarily long sequence of numbers should “look” random. That means that no sub-interval within (0,1) should be preferred, and there should be no recurring patterns or sequences of numbers. To be more precise, there should be no correlations between successive random numbers or sequences of of random numbers. We will return to this topic later and define some statistical and physical measures as how to study randomness.</p>
<p>You may ask if it really matters or if it is really so hard to define what is random. As for the first question, it is easy to convince yourself if you think of, for example, a very practical and important problem of data encryption. If your random numbers have predictable correlations or repeating patterns, it may become very easy to break the encryption, which, in practice, could lead, for example, to unsafe transmission of you credit card information with on-line purchases. As for the second question, try to come up with a definition of randomness! Is the sequence {1,1,1,1} more random than {2190,9,1,14,276}? If you picked one over the other, what is your criterion and can be it applied generally?</p>
<div class="section" id="historical-tidbits">
<h2>Historical tidbits<a class="headerlink" href="#historical-tidbits" title="Permalink to this headline">¶</a></h2>
<p>As John von Neumann joked, “Anyone who considers arithmetical methods of producing random digits is, of course, in a state of sin.”</p>
</div>
<div class="section" id="random-numbers-vs-pseudo-random-numbers">
<h2>Random numbers vs Pseudo-random numbers<a class="headerlink" href="#random-numbers-vs-pseudo-random-numbers" title="Permalink to this headline">¶</a></h2>
<blockquote>
'Random' numbers chosen by humans:
 In a recent study it was shown that 17 is the most common 'random number' 
when people were asked to choose a random number between 1 and 20. 
</blockquote>
<p>As indicated above, our aim is to generate random numbers using deterministic algorithms. That sounds almost like an oxymoron: how can we produce random numbers using a deterministic algorithm?</p>
<p>Let us first classify random numbers in the following two categories</p>
<ol class="simple">
<li><p>True random numbers and</p></li>
<li><p>Pseudo-random numbers.</p></li>
</ol>
<p>True random numbers are produced by a physical process such as radioactive decay. These numbers are truly random in the sense that there are no correlations present and that the successive numbers are totally unpredictable.</p>
<p>Those numbers are tabularized and may then be used. The problem is, however, that that method is very impractical. To overcome that difficulty, several algorithms have been developed  to produce sequences of pseudo-random numbers which mimic the true random numbers as well as possible. The goodness, i.e., quality, of these pseudo-random numbers can be tested in various ways as will be discussed below. When we discuss random numbers, we actually mean pseudo-random numbers unless otherwise mentioned.</p>
<p>Development of random number generators has been a very active field of research since (and already before) the invent of modern computers and remains to be so even today.</p>
</div>
<div class="section" id="requirements-for-a-good-random-number-generator">
<h2>Requirements for a good Random Number Generator<a class="headerlink" href="#requirements-for-a-good-random-number-generator" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Randomness</p></li>
<li><p>Long period.</p></li>
<li><p>RNG should be portable from one CPU architecture to another</p></li>
<li><p>The algorithm should be fast and use little memory</p></li>
<li><p>The algorithm should be parallelizable</p></li>
</ol>
</div>
<div class="section" id="uniform-random-numbers">
<h2>Uniform Random Numbers<a class="headerlink" href="#uniform-random-numbers" title="Permalink to this headline">¶</a></h2>
<p>When talking about random numbers, we typically mean uniformly distributed random numbers. Typically we mean that random numbers are uniformly distributed between 0 and 1. It is then possible to generate other distributions from thos uniform distribution, e.g., using the Box-Müller method.</p>
<div class="section" id="linear-congruential-generator-lcg">
<h3>Linear Congruential Generator (LCG)<a class="headerlink" href="#linear-congruential-generator-lcg" title="Permalink to this headline">¶</a></h3>
<p>Linear Congruential Generator are the one of the oldest and most common types of pseudo-random number generator. They are very easy to implement, they are fast, and use minimal amount of memory. They are also very portable, but the downside is that they do not produce high-quality random numbers.  Thus, when randomness is critical, LCGs should not be used. Such applications include calculation of critical exponents in continuous phase transitions and cryptography.</p>
<p>LCG generators are defined by</p>
<div class="amsmath math notranslate nohighlight" id="equation-33d15820-003f-48be-a52c-cab90e4699e0">
<span class="eqno">()<a class="headerlink" href="#equation-33d15820-003f-48be-a52c-cab90e4699e0" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x_{i+1} = (ax_i + c )\, \mathrm{mod} \, m
\end{equation}\]</div>
<p>The above is a recurrence relation and numbers <span class="math notranslate nohighlight">\(\{x_i \}\)</span> form a set of pseudo-random numbers. Notice also the above equation is defines line with a modulo operation added. The modulo operation means that the result is wrapped if it exceeds the limit set by <span class="math notranslate nohighlight">\(m\)</span> since the modulo operation returns the remainder of <span class="math notranslate nohighlight">\((ax_i + c)/m\)</span>. LCG generator is said to be of full period if the period is exactly <span class="math notranslate nohighlight">\(m\)</span>.</p>
<p>The parameters are defined as follows</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span>: multiplier. <span class="math notranslate nohighlight">\(1&lt;a&lt;m\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>: increment. <span class="math notranslate nohighlight">\(0 \le c &lt; m\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span>: period. The operation is even faster if <span class="math notranslate nohighlight">\(m\)</span> is chosen to be a power of 2.</p></li>
</ul>
<p>In addition, one needs a seed (<span class="math notranslate nohighlight">\(x_0\)</span>) to start the random number generator. The seed has to be supplied when the RNG is called the first time. Using the above parameters, the following notation is typically used for LCGs:</p>
<div class="amsmath math notranslate nohighlight" id="equation-30e82cd7-e36e-495f-9074-ac89475d1107">
<span class="eqno">()<a class="headerlink" href="#equation-30e82cd7-e36e-495f-9074-ac89475d1107" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathrm{LCG}(a,c,m)
\end{equation}\]</div>
<p>It has been well established that LCGs are very sensitive to the choice of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(m\)</span>. Generators with <span class="math notranslate nohighlight">\(c=0\)</span> are called multiplicative congruential generators (MCG). Sometimes generators with <span class="math notranslate nohighlight">\(c \&gt; 0\)</span> are called mixed. For MCG’s <span class="math notranslate nohighlight">\(0 &lt; s &lt; m\)</span>. It has been shown \cite{xx} that MCGs  are never full period. For MCGs, typical notation is thus</p>
<div class="amsmath math notranslate nohighlight" id="equation-8d4e5f14-df6e-4014-9ed5-682e2dc238ba">
<span class="eqno">()<a class="headerlink" href="#equation-8d4e5f14-df6e-4014-9ed5-682e2dc238ba" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathrm{LCG}(a,m).
\end{equation}\]</div>
<p>Note on choosing <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(m\)</span>: First of all, using a larger value for <span class="math notranslate nohighlight">\(m\)</span> (for a 32-bit computer one typically has <span class="math notranslate nohighlight">\(m=2^{32}\)</span>) gives a long period as it goes through all accessible numbers. That is not enough, but <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(c\)</span> have to be chose carefully as well. That is somewhat of an art and there are tables listing ‘safe’ numbers <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(m\)</span>.</p>
<p>LCGs have also the widely known property of the rightmost digits contain correlations \cite{xx}.</p>
</div>
<div class="section" id="fibonacci-method">
<h3>Fibonacci Method<a class="headerlink" href="#fibonacci-method" title="Permalink to this headline">¶</a></h3>
<p>LCGs can be improved by adding more multipliers, i.e., we obtain the form</p>
<div class="math notranslate nohighlight">
\[
x_i = (a_1 x_{i-1}+ \cdots a_r x_{i-r}) \, \mathrm{mod} \, m.
\]</div>
<p>Here we must have <span class="math notranslate nohighlight">\(r &gt;1\)</span>  and <span class="math notranslate nohighlight">\(a_r \ne 0\)</span>. If we choose <span class="math notranslate nohighlight">\(r=2\)</span>, <span class="math notranslate nohighlight">\(a_1=1\)</span>  and <span class="math notranslate nohighlight">\(a_2=1\)</span>, we obtain the so-called Fibonacci generator</p>
<div class="math notranslate nohighlight">
\[
x_i = (x_{i-1}+ x_{i-2}) \, \mathrm{mod} \, m.
\]</div>
<p>The name of the method comes from Fibonacci numbers (This sequence was know to Indian mathematicians even earlier, but Fibonacci introduced it in Europe in 1202) which are defined as a sequence</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_n =  \left\{
\begin{array}{ll }
      0 &amp; \, \mathrm{if \,}\,  n=0    \\
      1 &amp;    \, \mathrm{if \,}\, n=1 \\
      x_{n-1} + x_{n-2}  &amp; \, \mathrm{if \,}\, n&gt;1.
\end{array}
 \right. 
\end{split}\]</div>
<p>Give the two ‘seeds’, each number is a sum of the two immediately preceding numbers. Fibonacci sequence looks like this</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{| l| l | l | l | l | l | l | l | l | l | l |} \hline
      x_0 &amp; x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; x_5 &amp; x_6 &amp; x_7 &amp; x_8 &amp; x_9 &amp; x_{10}    \\ \hline
      0     &amp;  1     &amp; 1    &amp;  2     &amp;  3    &amp; 5     &amp; 8      &amp; 13   &amp;  32   &amp; 34  &amp; 55 \\  \hline
\end{array}
\end{split}\]</div>
<p>As such, this method for random number generation does not have particularly good properties. LCGs are typically preferred over them. The Fibonacci generator can be improved, however.</p>
</div>
<div class="section" id="lagged-fibonacci-generator-lfg">
<h3>Lagged Fibonacci Generator (LFG)<a class="headerlink" href="#lagged-fibonacci-generator-lfg" title="Permalink to this headline">¶</a></h3>
<p>LFG is based on a generalization of the above Fibonacci  sequence, but now a lag is defined by two integers <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(r\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
x_i = (x_{i-q} \otimes x_{i-r}) \mathrm{\,mod\,} m.
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(q&gt;r\)</span> and operation <span class="math notranslate nohighlight">\( \otimes \)</span> is one of the following binary operations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
     + &amp; \, \mathrm{addition}    \\
      - &amp;  \, \mathrm{subtraction} \\
      \times &amp; \,  \mathrm{multiplication} \\
      \oplus &amp;  \, \mathrm{XOR\,\, \mathrm{(exclusive\,\, OR)}\, if\,\,}\, m\, \mathrm{is\, a \,power\, of\, two.}   
\end{array}
\end{split}\]</div>
<p>Notation for LFG generators is then the following:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{LFG}(q,r,\otimes).
\]</div>
<p>Initialization of an LFG generator requires <span class="math notranslate nohighlight">\(q\)</span> seeds which can be produced using another RNG.</p>
<p>LFGs have a long period, and they seem to have good properties.  Since they are fairly new, they have not been studied to such extent as the LCGs have.</p>
<p>An example of a fairly commonly used LFG generator is RAN3 from Numerical Recipes. The exact form of RAN3 is LFG(55,24,-).</p>
<!-- 
Generalized Feedback Shift Register Generators (GFSR)
--><!-- 
Mersenne Twister
--></div>
<div class="section" id="few-words-on-implementation">
<h3>Few words on implementation<a class="headerlink" href="#few-words-on-implementation" title="Permalink to this headline">¶</a></h3>
<p>Although the above methods look simple, one has to pay attention to their implementation. Vattulainen \cite{xx} has pointed out that that using single precision instead of double precision in the case of an LFG can lead to a decrease in period by a factor of about <span class="math notranslate nohighlight">\(10^7\)</span>.</p>
</div>
<div class="section" id="how-to-produce-different-distributions">
<h3>How to produce different distributions<a class="headerlink" href="#how-to-produce-different-distributions" title="Permalink to this headline">¶</a></h3>
<p>So far we have only discussed generating random numbers in a uniform distribution, but at quite some length. There is a good reason to this - random numbers in any other distribution are almost always generated starting from random numbers distributed uniformly between 0 and 1.</p>
<p>But in physics it is clear that data often comes in many other forms. For example, the peaks in various spectra have a Gaussian or Lorentzian shape, the decay activity of a radioactive sample follows an exponential function, and so on.</p>
<p>There are two basic approaches to generate other distributions than the uniform. The first is the analytical one, the other the numerical von Neumann rejection method.</p>
<p>The above discussion was limited to evenly distributed random numbers. In many practical applications, one has to produce random numbers distributed according to some other distribution(s). The practical question is: how to produce random numbers following a pre-defined distribution using random numbers which are evenly distributed in <span class="math notranslate nohighlight">\((0,1)\)</span>. Why should be use evenly distributed random numbers as our starting point?</p>
<div class="section" id="gaussian-distribution-the-box-muller-algorithm">
<h4>Gaussian distribution: The Box-Müller algorithm<a class="headerlink" href="#gaussian-distribution-the-box-muller-algorithm" title="Permalink to this headline">¶</a></h4>
<p>In this method, we also consider two Gaussian distributions in 2D. Their joint distribution is</p>
<div class="math notranslate nohighlight">
\[
f(x,y)= \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}x^2} \frac{1}{\sqrt {2 \pi}} e^{-\frac{1}{2}y^2} = \frac{1}{2 \pi} e^{-\frac{1}{2}x^2+y^2}
\]</div>
<p>Switching to polar coordinates, and remembering that the surface element transforms as <span class="math notranslate nohighlight">\(dx \,dy = r \, dr \,d \phi\)</span> we get the polar density distribution function</p>
<div class="math notranslate nohighlight">
\[
g(r, \phi) = f(x,y) r = \frac{1}{2 \pi} e^{- \frac{1}{2}r^2}
\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight" id="equation-fa951653-badd-476a-8693-e97ade1c2343">
<span class="eqno">()<a class="headerlink" href="#equation-fa951653-badd-476a-8693-e97ade1c2343" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
g_1 &amp; = &amp; \sqrt{-2 \ln (r_1) \cos ( 2 \pi r_2)} \\
g_2 &amp; = &amp;  \sqrt{-2 \ln (r_1) \sin ( 2 \pi r_2)}
\end{eqnarray}\]</div>
<p>Algorithmically this method is fine, there is no wasted effort in terms of misses or something like that. But in terms of computational efficiency, it leaves much to be hoped for. It requires computation of the functions such a square root, <span class="math notranslate nohighlight">\(\log\)</span>, <span class="math notranslate nohighlight">\(\sin\)</span> and <span class="math notranslate nohighlight">\(\cos\)</span>. Calculating all of these, and especially the last three ones, is excruciatingly slow compared to the simple arithmetic operations. So it would be nice to have a more efficient routine.</p>
</div>
</div>
<div class="section" id="how-to-test-random-number-generators">
<h3>How to test Random Number Generators<a class="headerlink" href="#how-to-test-random-number-generators" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Statistical tests</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Kolmogorov-Smirnov test</p></li>
<li><p><span class="math notranslate nohighlight">\(\xi^2\)</span> test</p></li>
<li><p>Spectral tests</p></li>
</ul>
</div></blockquote>
<ol class="simple">
<li><p>Bit-wise tests (if the RNG uses integer arithmetics)</p></li>
<li><p>Visual tests</p></li>
<li><p>Physical tests</p></li>
</ol>
<!-- 
## Final remarks 

Now, when generators tend to be at least fairly decent, the following opinion is probably close to the truth (at least in a male-chauvinistic worldview): 

<blockquote>
A random number generator is much like sex: 
when it is good it is wonderful and when it is bad 
it is still pretty good.<br>
- George Marsaglia 
</blockquote>

--></div>
</div>
<div class="section" id="random-numbers-using-python">
<h2>Random numbers using Python<a class="headerlink" href="#random-numbers-using-python" title="Permalink to this headline">¶</a></h2>
<!-- To verify: Numpy uses Mersenne twister -->
<p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code></p>
<p>There is no need to define the seed. But sometimes it is a good idea to do so:</p>
<p><code class="docutils literal notranslate"> <span class="pre">seed</span> <span class="pre">=</span> <span class="pre">182828</span>&#160; <span class="pre">np.random.seed(seed)</span></code></p>
<div class="section" id="id1">
<h3>Uniform random numbers<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Single random number drawn from a uniform distribution <span class="math notranslate nohighlight">\(x_i \in [0.0,1.0)\)</span></p>
<p><code class="docutils literal notranslate"> <span class="pre">np.random.random()</span>&#160; <span class="pre">np.random.rand()</span></code></p>
<p>Array of random numbers (from a uniform distribution <span class="math notranslate nohighlight">\(x_i \in [0.0,1.0)\)</span>) of length 2:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.random.rand(2)</span></code></p>
</div>
<div class="section" id="gaussian-random-numbers">
<h3>Gaussian random numbers<a class="headerlink" href="#gaussian-random-numbers" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">np.random.standard_normal()</span></code></p>
</div>
<div class="section" id="integer-s-within-given-limits">
<h3>Integer(s) within given limits<a class="headerlink" href="#integer-s-within-given-limits" title="Permalink to this headline">¶</a></h3>
<p>A single random number between 0 and 100:</p>
<p><code class="docutils literal notranslate"> <span class="pre">np.random.randint(low</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">high</span> <span class="pre">=</span> <span class="pre">100)</span></code></p>
<p>The following gives an array of 5 random numbers between 0 and 100:</p>
<p><code class="docutils literal notranslate"><span class="pre">np.random.randint(low</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">high</span> <span class="pre">=</span> <span class="pre">100,</span> <span class="pre">size</span> <span class="pre">=</span> <span class="pre">5)</span></code></p>
<!-- 
Let's try all of the above:
-->
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">182828</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One random number from a uniform distribution:&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One random number from a uniform distribution:&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array of two random numbers from a uniform distribution:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One random number from a Gaussian distribution:&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One random integer between 0 and 100:&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array of five random integers between 0 and 100:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>One random number from a uniform distribution: 0.44331155621976326
One random number from a uniform distribution: 0.17132956737846639
Array of two random numbers from a uniform distribution: [0.14745103 0.65128666]
One random number from a Gaussian distribution: 0.040542727890789124
One random integer between 0 and 100: 46
Array of five random integers between 0 and 100: [75 48 58 68  9]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="role-of-random-numbers-in-parallel-stochastic-simulations">
<h2>Role of random numbers in parallel stochastic simulations<a class="headerlink" href="#role-of-random-numbers-in-parallel-stochastic-simulations" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>        \label{sec:roleofrandomnumbersinparallel}} 
</pre></div>
</div>
<p>Perhaps surprisingly, random numbers are used extensively in
numerous both scientific and practical applications. Stochastic
simulations in physical sciences \cite{Fre02,Gen03,Bin02} characterize
this fact very well. There, where the aim is to model complex systems
over large length and time scales, atomistic approaches such as
classical molecular dynamics are therefore no longer feasible.
Examples of such stochastic techniques include the Monte Carlo
method, Brownian dynamics simulations, and Dissipative Particle
Dynamics (DPD), which all use pseudorandom numbers to generate
the dynamics of model systems under study. Due to the
deterministic nature of pseudorandom numbers, it is obvious
that if there are any significant correlations within
pseudorandom number sequences, then the dynamics of these model
systems will be biased and the reliability of the whole approach
may become questionable. To avoid such concerns, pseudorandom
number generators should be thoroughly tested before extensive
use in model simulations. This is particularly true as regards
stochastic simulations in a parallel environment and in
large-scale studies of soft matter systems, where the number
of random numbers used is typically huge.</p>
<p>Below, we consider these two topics side by side. We first
discuss recent ideas \cite{Vat99} on how to test the quality of
random numbers in parallel applications in terms of random walks.
As it turns out, this approach is both simple and efficient, and
is able to reveal correlation effects in a number of commonly used
pseudorandom number generators. Second, we study the effects of the
quality of random numbers on DPD simulations
\cite{groot97a,warren98a,espanol95a,hoogerbrugge92a},
which are based on solving Newton’s equations of motion in the
presence of a stochastic force component. The results indicate
a few promising generators whose performance in the present
tests is rather remarkable.</p>
<p>\subsubsection{How to test parallel random number generators
by random walks
\label{sec:howtotestparallel}}</p>
<p>Parallel computing and parallel random number generation have
been active fields of research for a relatively long time.
With the exception of a few interesting studies
\cite{Mas98,Ent98,Sri03},
much less attention has been devoted to design tests, which
are specifically suited for gauging correlations in parallel
random number generators. This is partly due to a great number
of {\it general} test methods that have been developed and
used during the last few decades \cite{Knu98}. In this general
approach that is common to numerous standard tests, correlations
are looked for from a very long random number sequence <span class="math notranslate nohighlight">\(\{ x_i \}\)</span>.
This approach works very well in serial computing where the whole
random number sequence is used on a single central computing unit
(CPU). In parallel applications, however, the case is more
complicated. Then it is more practical to consider relatively
short subsequences <span class="math notranslate nohighlight">\(\{ x_i \}^{(k)}\)</span>, <span class="math notranslate nohighlight">\(i = 1, \ldots, \Omega_k\)</span>,
where subsequences <span class="math notranslate nohighlight">\(k = 1,\ldots,m\)</span> do not overlap and are used
on distinct CPUs during the calculation, as the task is
distributed as subtasks between a number of different computing
units. Obviously, the interest is now on {\it cross-correlations}
between distinct random number sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(1)}, \ldots, \{ x_i \}^{(m)}\)</span>.
To study such effects, one needs specific approaches
that gauge long-range correlations between blocks of random
numbers.</p>
<p>We consider this problem in terms of random walks, which
are a common tool in a variety of disciplines, including
physics, chemistry, biology, and economics.  We use
random walks to characterize the quality of random numbers in
parallel calculations. The key idea is to consider a number of
diffusing random walkers, each of which is governed by a distinct
random number sequence. Through studies of their mutual
correlations we are then able to characterize and quantify
possible correlations between separate pseudorandom number
sequences. To this end, we calculate quantities such as
intersection probabilities between different random walks
and compare their asymptotic behavior to known theoretical
limits. The difference between simulation results and theoretical
predictions serves as a measure of correlations in the random
number generator under study.</p>
<p>In the following, we briefly describe three tests \cite{Vat99}
that are based on this idea. They study both correlations
within a single random number sequence <span class="math notranslate nohighlight">\(\{ x_i \}^{(k)}\)</span>
and cross-correlations between distinct random number sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(1)}, \ldots, \{ x_i \}^{(m)}\)</span>. The sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(k)}\)</span> are generated by the pseudorandom number
generator in question from
<span class="math notranslate nohighlight">\(\{ x_i \} = x_1,\ldots,x_{\Omega},x_{\Omega+1},\ldots,x_{2\Omega},\ldots\)</span>
such that we obtain non-overlapping sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(1)} = x_1,\ldots,x_{\Omega}\)</span>,
<span class="math notranslate nohighlight">\(\{ x_i \}^{(2)} = x_{\Omega+1},\ldots,x_{2\Omega}\)</span>, and so on.
Here we consider the case where the sizes <span class="math notranslate nohighlight">\(\Omega_k\)</span> of sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(k)}\)</span> are equal for all <span class="math notranslate nohighlight">\(k\)</span>. Random numbers <span class="math notranslate nohighlight">\(x_i\)</span> are
uniformly distributed between zero and one.</p>
<p>\subsubsection{Tests based on random walks
\label{sec:testsbasedonrandomwalks}}</p>
<p>In the {\it height correlation test}, we consider the position
<span class="math notranslate nohighlight">\(y_i\)</span> of a one-dimensional random walker vs. the number of jumps
made <span class="math notranslate nohighlight">\(i\)</span>. The position <span class="math notranslate nohighlight">\(y_t = \sum_{i=1}^{t} \delta y_i\)</span> is a
sum of displacements <span class="math notranslate nohighlight">\(\delta y_i\)</span>, which are random variables</p>
<div class="amsmath math notranslate nohighlight" id="equation-e2f90dac-f042-4482-aded-37f4281af589">
<span class="eqno">()<a class="headerlink" href="#equation-e2f90dac-f042-4482-aded-37f4281af589" title="Permalink to this equation">¶</a></span>\[\begin{equation} 
\delta y_i = \left\{\begin{array}{rl}
               +1 , &amp; \mbox{if $x_i \leq 1/3$;} \\
                0 , &amp; \mbox{if $1/3 &lt; x_i \leq 2/3$;} \\
               -1 , &amp; \mbox{otherwise.} \\
               \end{array}
               \right .
\end{equation}\]</div>
<p>In this manner, we construct the paths <span class="math notranslate nohighlight">\(y_i^{(1)}\)</span> and <span class="math notranslate nohighlight">\(y_i^{(2)}\)</span>
from the sequences <span class="math notranslate nohighlight">\(\{ x_i \}^{(1)}\)</span> and <span class="math notranslate nohighlight">\(\{ x_i \}^{(2)}\)</span>,
respectively. Using the initial condition <span class="math notranslate nohighlight">\(y_0^{(1)} = y_0^{(2)} = 0\)</span>,
the height between the two random walkers is defined as
<span class="math notranslate nohighlight">\(h_t = y_t^{(1)} - y_t^{(2)}\)</span>. For a random process, the
corresponding correlation function
<span class="math notranslate nohighlight">\(H_t \equiv \langle | h_t - h_0 | \rangle \sim t^{\phi}\)</span>
decays asymptotically as a power law with an exponent <span class="math notranslate nohighlight">\(\phi = 1/2\)</span>
\cite{Kru97}.</p>
<p>The {\it intersection test} deals with two random walkers on
a square lattice. The random walkers start from the origin at
the same time and are allowed to jump independently on a lattice.
Meanwhile, we consider the probability <span class="math notranslate nohighlight">\(I_t\)</span> that the two random
walkers after <span class="math notranslate nohighlight">\(t\)</span> jumps have {\it no} intersection other than their
common starting point. Note that the two random walks need
not meet at the same site at the same time, but any common point
in their paths is regarded as an intersection. For a random process,
<span class="math notranslate nohighlight">\(I_t\)</span> behaves asymptotically like a power law <span class="math notranslate nohighlight">\(I_t \sim t^{-\alpha}\)</span>
with an exponent <span class="math notranslate nohighlight">\(\alpha = 5/8\)</span> \cite{Dup88,Bur90}.</p>
<p>In the {\it <span class="math notranslate nohighlight">\(S_N\)</span>–test}, we consider <span class="math notranslate nohighlight">\(N\)</span> random walkers in one
dimension and let them move simultaneously without any interaction
such that, at any jump attempt, they can make a jump to the left or
to the right with equal probability. After <span class="math notranslate nohighlight">\(t \gg 1\)</span> jumps by all
random walkers, the mean number of sites visited <span class="math notranslate nohighlight">\(S_{N,t}\)</span> has an
asymptotic form <span class="math notranslate nohighlight">\(S_{N,t} \sim f(N) t^{\gamma}\)</span>, where the scaling
function <span class="math notranslate nohighlight">\(f(N) = (\ln N)^{1/2}\)</span> and  <span class="math notranslate nohighlight">\(\gamma = 1/2\)</span> \cite{Lar92}.
The value of <span class="math notranslate nohighlight">\(\gamma\)</span> observed serves as a measure of correlations.</p>
<p>Values of the parameters used in the tests discussed below are
given in Table~\ref{Table1}. There <span class="math notranslate nohighlight">\(\Omega\)</span> is the number of jumps
in a single random walk, and <span class="math notranslate nohighlight">\(M\)</span> is the number of independent runs
in the test.</p>
<p>\subsubsection{Results for some pseudorandom number generators
\label{sec:rngs}}</p>
<p>Here we discuss results of the three tests for a few carefully<br />
chosen pseudorandom number generators. The present results
complement previous investigations discussed in more
detail in Ref.~\cite{Vat99}.</p>
<p>The generators discussed in this work represent a variety of
different generators often used within the physics community.
R250 is an implementation of the generalized feedback
shift-register (GFSR) algorithm \cite{Lew73}
<span class="math notranslate nohighlight">\(x_n = x_{n-250} \oplus x_{n-103}\)</span>, where <span class="math notranslate nohighlight">\(\oplus\)</span> is the
bitwise exclusive OR operator. R89 is another example of
GFSR generators and uses <span class="math notranslate nohighlight">\(x_n = x_{n-89} \oplus x_{n-38}\)</span>.
RAN is a <code class="docutils literal notranslate"><span class="pre">minimal''</span> <span class="pre">linear</span> <span class="pre">congruential</span> <span class="pre">generator</span> <span class="pre">of</span> <span class="pre">Park</span>&#160; <span class="pre">and</span> <span class="pre">Miller</span> <span class="pre">(with</span> <span class="pre">multiplier</span> <span class="pre">16807</span> <span class="pre">and</span> <span class="pre">modulus</span> <span class="pre">$2^{31}-1$)</span>&#160; <span class="pre">combined</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">Marsaglia</span> <span class="pre">shift</span> <span class="pre">sequence,</span> <span class="pre">and</span> <span class="pre">has</span> <span class="pre">been</span>&#160; <span class="pre">proposed</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">recent</span> <span class="pre">edition</span> <span class="pre">of</span> <span class="pre">Numerical</span> <span class="pre">Recipes</span> <span class="pre">\cite{Pre96}.</span>&#160; <span class="pre">RAN2</span> <span class="pre">is</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">32-bit</span> <span class="pre">combination</span> <span class="pre">generator</span>&#160; <span class="pre">first</span> <span class="pre">proposed</span> <span class="pre">by</span> <span class="pre">L'Ecuyer</span> <span class="pre">\cite{Lec88}</span> <span class="pre">and</span> <span class="pre">later</span> <span class="pre">published</span>&#160; <span class="pre">in</span> <span class="pre">Numerical</span> <span class="pre">Recipes</span> <span class="pre">\cite{Pre92}</span> <span class="pre">using</span> <span class="pre">shuffling.</span> <span class="pre">RANMAR</span>&#160; <span class="pre">\cite{Jam90,Mar90}</span> <span class="pre">combines</span> <span class="pre">a</span> <span class="pre">lagged</span> <span class="pre">Fibonacci</span> <span class="pre">generator</span>&#160; <span class="pre">with</span> <span class="pre">a</span> <span class="pre">simple</span> <span class="pre">arithmetic</span> <span class="pre">sequence,</span> <span class="pre">and</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">suggested</span> <span class="pre">as</span>&#160; <span class="pre">a</span> <span class="pre">good</span> <span class="pre">candidate</span> <span class="pre">when</span> <span class="pre">one</span> <span class="pre">aims</span> <span class="pre">towards</span> <span class="pre">a</span> </code>universal generator’’
\cite{Mar90}.
Additionally we test the Mersenne Twister \cite{Mat98}, which
has a huge period and good theoretical properties in view of
recent studies by Matsumoto and Nishimura \cite{Mat98}. Finally,
we consider the most ``luxurious’’ version of RANLUX
\cite{Lus94,Jam94}, which is based on ideas of deterministic
chaos. In RANLUX4, one generates <span class="math notranslate nohighlight">\(389\)</span> random numbers, delivers
24 of them, and throws the remaining <span class="math notranslate nohighlight">\(365\)</span> numbers away.</p>
<p>To determine the exponents <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span>, we
considered their ``running exponents’’ defined as</p>
<div class="amsmath math notranslate nohighlight" id="equation-a663f58a-c06f-4fcb-a7f9-ebafd5842542">
<span class="eqno">()<a class="headerlink" href="#equation-a663f58a-c06f-4fcb-a7f9-ebafd5842542" title="Permalink to this equation">¶</a></span>\[\begin{equation} 
\label{running} 
\phi_t \equiv \frac{ \log ( H_{t + \delta t} / H_{t} )}
	             { \log [ (t + \delta t) / t ] }  \, , 
\end{equation}\]</div>
<p>where the present example is for the height correlation test.
Running exponents of <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> were determined in a
similar fashion. The ``time window’’ <span class="math notranslate nohighlight">\(\delta t \)</span> used in this
work varied between 50 and 1000.</p>
<p>Demonstrative results for the running exponents
are shown in Fig.~\ref{fig:exponents_rng}. The initial behavior of
some generators is clearly different and is discussed below in more
detail. Nevertheless, asymptotically, we find the running exponents
of all generators to converge to some limiting value at large <span class="math notranslate nohighlight">\(t\)</span>.
This regime was therefore used to determine the exponents.</p>
<p>The results for the exponents <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> are
given in Table~\ref{Table2}. Results of the GFSR generators R89
and R250 are not surprising, since they have recently failed in
various random walk tests (see references in \cite{Vat99}).
RANLUX4 and RANMAR, on the other hand, perform considerably
better, in agreement with some previous studies
\cite{Vat99,Mar90,Vat94,Vat95,Vat95cpc,Sch98}.
Equally good performance is found
for the Mersenne Twister and RAN2, while the results of RAN in
the intersection test are not fully convincing. Then, the
exponent <span class="math notranslate nohighlight">\(\alpha\)</span> deviates from the theoretical limit, and this
deviation seems to be systematic as is demonstrated by
Fig.~\ref{fig:exponents_rng} (middle). When the intersection test
was repeated for RAN, we found <span class="math notranslate nohighlight">\(\alpha = 0.6239(4)\)</span>, which
again fails the test.</p>
<p>The tests presented above focus on the asymptotic behavior of the
corresponding correlation functions. This is due to the fact that
only the asymptotic behavior of the correlation functions is known
theoretically. Yet correlations in pseudorandom number sequences
are playing a role also at shorter scales, as is very evident from
the running exponents in Fig.~\ref{fig:exponents_rng}. For cases
where such short-range correlations are of interest, one can use
a two-way analysis in which various pseudorandom number generators
are judged against a reference generator. This approach was used in
Ref.~\cite{Vat99}, which revealed further correlations in a few
random number generators, including RANMAR.</p>
<p>At the present stage, we conclude that even highly recommended
and commonly used pseudorandom number generators may fail in
tests that focus on their weak points. Generally, one can safely say
that there are no good pseudorandom number generators. All of them
are bad. It is simply a question of finding those that are better
and more reliable than the others. We will discuss this broad
issue in more depth in Sect.~\ref{sect:disc_pseudorandom}.
Meanwhile, to get further insight into the use and impact
of random numbers in stochastic simulations, we consider their
influence on dissipative particle dynamics simulations.</p>
<p>\subsection{Role of random numbers in
dissipative particle dynamics simulations
\label{sec:roleofthequalitydpd}}</p>
<p>Above we have stressed the importance of developing techniques
for multi-scale modeling. Development of stochastic simulation
techniques play a crucial role in this respect. This is simply
due to the fact that many important processes in soft matter
systems take place at mesoscopic length and time scales
(roughly 1–1000 nm and 1–1000 ns), which are beyond the limits
of atomic-scale molecular dynamics. To overcome this problem,
stochastic simulation methods such as DPD discussed in
Sect.~\ref{sec:dpd} are hence needed.</p>
<p>The role of random numbers in DPD is crucial. This is due to
the fact that particles in DPD model systems are partly driven by
stochastic noise, which is generated by pseudorandom numbers. Any
correlations in pseudorandom number sequences can therefore lead
to serious problems, if they interfere with the true dynamics of
the system.</p>
<p>To study how sensitive DPD actually is to such underlying
correlations in pseudorandom number sequences, we consider
a simple model fluid system described by <span class="math notranslate nohighlight">\(N\)</span> particles with
masses <span class="math notranslate nohighlight">\(m_i\)</span>, coordinates <span class="math notranslate nohighlight">\(\vec{r}_i\)</span>, and velocities <span class="math notranslate nohighlight">\(\vec{v}_i\)</span>.
Interparticle interactions are characterized by the pairwise
conservative, dissipative, and random forces exerted on particle
<code class="docutils literal notranslate"><span class="pre">$i$''</span> <span class="pre">by</span> <span class="pre">particle</span> </code><span class="math notranslate nohighlight">\(j\)</span>’’, respectively, and are given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-769e30af-48d0-47e2-acbe-da7b44885daf">
<span class="eqno">()<a class="headerlink" href="#equation-769e30af-48d0-47e2-acbe-da7b44885daf" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{array}{lcl} 
\label{DPD_forces}
\vec{F}_{ij}^C &amp;=&amp; \alpha\ \omega (r_{ij})\  
   \vec{e}_{ij}\,,\label{forces:1}\\
\vec{F}_{ij}^D &amp;=&amp; -\gamma\ \omega^2 (r_{ij})\
   (\vec{v}_{ij}\!\cdot\! \vec{e}_{ij})\, \vec{e}_{ij}\,,\\
\vec{F}_{ij}^R &amp;=&amp; \sigma\ \omega (r_{ij})\ \xi_{ij}\ 
   \vec{e}_{ij}\,,\label{forces:2}
\end{array} 
\end{equation}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\vec{r}_{ij} = \vec{r}_i - \vec{r}_j\)</span>,
<span class="math notranslate nohighlight">\(r_{ij} = | \vec{r }_{ij} |\)</span>,
<span class="math notranslate nohighlight">\(\vec{e}_{ij} = \vec{r}_{ij} / r_{ij}\)</span>, and
<span class="math notranslate nohighlight">\(\vec{v}_{ij} = \vec{v}_i - \vec{v}_j\)</span>.</p>
<p>The weight function for the different interaction terms has
here been chosen to follow the same form. Random numbers appear
in these equations by describing <span class="math notranslate nohighlight">\(\xi_{ij}\)</span>, which are symmetric
random variables with zero mean and unit
variance. <span class="math notranslate nohighlight">\(\xi_{ij}\)</span> are expected to be uncorrelated for different
pairs of particles and different times, and it is indeed random
numbers whose task is to satisfy this condition.</p>
<p>Remaining details are fixed by adopting a commonly made choice
for the weight function</p>
<div class="amsmath math notranslate nohighlight" id="equation-5b9f333a-127d-4e1a-86ef-4adc13b5c809">
<span class="eqno">()<a class="headerlink" href="#equation-5b9f333a-127d-4e1a-86ef-4adc13b5c809" title="Permalink to this equation">¶</a></span>\[\begin{equation}
  \label{eq:omega_rij_2nd}
  \omega(r_{ij}) = \left\{
  \begin{array}{ll}
    1 - r_{ij}/r_c &amp; \mbox{for $r_{ij}&lt;r_c$}; \\
    0 &amp; \mbox{for $r_{ij}&gt;r_c$},
  \end{array}
  \right.
  \end{equation}\]</div>
<p>with a cut-off distance <span class="math notranslate nohighlight">\(r_c\)</span> \cite{warren98a} and
<span class="math notranslate nohighlight">\(\omega^{R}(r_{ij}) = \omega(r_{ij})\)</span>. Then the equations
of motion are given by the set of stochastic
differential equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-32d57d8b-f5b7-428f-9730-0963962c9e17">
<span class="eqno">()<a class="headerlink" href="#equation-32d57d8b-f5b7-428f-9730-0963962c9e17" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{array}{lcl} 
\label{equs_of_motion}

d \vec{v}_i &amp;=&amp; \frac{\displaystyle 1}{\displaystyle m_i}
   \left( \vec{F}_i^{C}\,dt + \vec{F}_i^{D}\,dt + 
   \vec{F}_i^R\,\sqrt{dt}\,\right)\,,\label{motion:2}
% \label{equs_of_motion2}
\end{array} 
\end{equation}\]</div>
<p>where ,<span class="math notranslate nohighlight">\(\vec{F}_i^{R} = \sum_{j \not= i} \vec{F}_{ij}^{R}\)</span>,
is the total random force acting on particle ``<span class="math notranslate nohighlight">\(i\)</span>’’ (with
<span class="math notranslate nohighlight">\(\vec{F}_i^{C}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}_i^{D}\)</span> defined correspondingly).</p>
<p>\subsubsection{Model system\label{Sec:dpdmodel}}</p>
<p>To maximize the role of random numbers, we study a simple model
fluid system of identical particles (<span class="math notranslate nohighlight">\(m_i = m\)</span> <span class="math notranslate nohighlight">\(\forall i\)</span>) in
the absence of conservative forces (<span class="math notranslate nohighlight">\(\alpha = 0\)</span>). This choice
corresponds to an ideal gas, which provides us with some exact
theoretical results to be compared with those of model simulations.
The dynamics of the system then arises only from random noise
and from a dissipative coupling between pairs of particles.
The random force strength is chosen as <span class="math notranslate nohighlight">\(\sigma = 10\)</span>, and the
dissipation strength is given by the fluctuation-dissipation
relation <span class="math notranslate nohighlight">\(\sigma^2 / \gamma = 2 \, k_\mathrm{B} T^*\)</span> \cite{espanol95a},
where the desired thermal energy is chosen as <span class="math notranslate nohighlight">\(k_\mathrm{B} T^* = 1\)</span>.
The length scale is defined by <span class="math notranslate nohighlight">\(r_c = 1\)</span>, and time is given
in units of <span class="math notranslate nohighlight">\(r_c \sqrt{ m / k_\mathrm{B} T}\)</span>.</p>
<p>In our simulations we use a 3D box of size <span class="math notranslate nohighlight">\(10 \times 10 \times 10\)</span>
with periodic boundary conditions and a particle density <span class="math notranslate nohighlight">\(\rho = 4\)</span>.
Equations of motion [Eq.~(\ref{equs_of_motion})] are solved in
practice using the recently suggested integration scheme known
as DPD–VV \cite{besold00a,nikunen03:a,vattulainen02a}, and
the time step used in this procedure was <span class="math notranslate nohighlight">\(\Delta t = 0.001\)</span>.
With this choice, the average temperature during simulations
<span class="math notranslate nohighlight">\(\langle k_\mathrm{B} T \rangle\)</span> remains at the desired value within 1%.
The results shown below are for simulations of <span class="math notranslate nohighlight">\(10^6\)</span> time steps
after equilibration, which takes about 200 CPU-hours each on a
typical RISC workstation.</p>
<p>Since the results depend on how the random number sequences are
used, we discuss this issue in some detail. Consider particles
<span class="math notranslate nohighlight">\(i = 1, \ldots, N\)</span>. For every pair of particles at a given
moment, we need to generate an independent and symmetric random
variable <span class="math notranslate nohighlight">\(\xi_{ij}\)</span> with zero mean and unit variance, which here
is done using uniformly distributed random numbers with unit
variance \cite{groot97a}. Then using the particle <code class="docutils literal notranslate"><span class="pre">1''</span> <span class="pre">as</span> <span class="pre">an</span>&#160; <span class="pre">example,</span> <span class="pre">one</span> <span class="pre">finds</span> <span class="pre">all</span> <span class="pre">other</span> <span class="pre">particles</span> </code><span class="math notranslate nohighlight">\(j\)</span>’’ which interact with
the particle <code class="docutils literal notranslate"><span class="pre">1''</span> <span class="pre">(i.e.</span> <span class="pre">particles</span> <span class="pre">for</span> <span class="pre">which</span> <span class="pre">$r_{1j}</span> <span class="pre">\leq</span> <span class="pre">r_c$).</span>&#160;&#160; <span class="pre">Suppose</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">such</span> <span class="pre">particles</span>&#160; <span class="pre">$\{j_1,</span> <span class="pre">j_2,</span> <span class="pre">\ldots,</span> <span class="pre">j_K\}$</span> <span class="pre">is</span> <span class="pre">$K$.</span> <span class="pre">Then</span> <span class="pre">one</span> <span class="pre">generates</span>&#160; <span class="pre">a</span> <span class="pre">random</span> <span class="pre">number</span> <span class="pre">sequence</span> <span class="pre">$\{</span> <span class="pre">x_i</span> <span class="pre">\}</span> <span class="pre">=</span> <span class="pre">x_1,\ldots,x_K$</span>&#160; <span class="pre">such</span> <span class="pre">that</span> <span class="pre">$x_1$</span> <span class="pre">determines</span> <span class="pre">$\xi_{1</span> <span class="pre">j_1}$,</span>&#160; <span class="pre">$x_2$</span> <span class="pre">determines</span> <span class="pre">$\xi_{1</span> <span class="pre">j_2}$,</span> <span class="pre">and</span> <span class="pre">so</span> <span class="pre">forth.</span> <span class="pre">The</span> <span class="pre">same</span>&#160; <span class="pre">procedure</span> <span class="pre">is</span> <span class="pre">then</span> <span class="pre">performed</span> <span class="pre">for</span> <span class="pre">all</span> <span class="pre">particles</span> <span class="pre">interacting</span>&#160; <span class="pre">with</span> <span class="pre">the</span> <span class="pre">particles</span> </code>2’’ through ``<span class="math notranslate nohighlight">\(N-1\)</span>’’, such that
each pair of particles is considered exactly once.</p>
<p>The results below have not been published elsewhere, which
possibly explains our interest to specify the present model
in great detail.</p>
<p>\subsubsection{Results for some pseudorandom number generators
\label{sec:resultsforrngsdpd}}</p>
<p>In the present discussion, we consider a small sample of the
generators described in Sect.~\ref{sec:rngs}. We focus on the
radial distribution function <span class="math notranslate nohighlight">\(g(r)\)</span> \cite{Mar76} that is one
of the most central observables in studies of liquids and
solid systems. For the ideal gas considered
here, <span class="math notranslate nohighlight">\(g(r) \equiv 1\)</span> for all <span class="math notranslate nohighlight">\(r\)</span>, and therefore any deviation
from one has to be interpreted as an artifact due to the employed
simulation scheme. This approach provides a simple and effective
measure of correlation effects and serves our main interest to
see how sensitive DPD is to the underlying correlations in
pseudorandom number sequences.</p>
<p>Results shown in Fig.~\ref{fig:gr_vcf_rng} (left) indicate
that differences between the generators are small. For all
generators tested, the radial distribution function is almost
flat and has only minor deviations from the expected behavior.
Did we expect something else that would have allowed us to
conclude that some pseudorandom number generators lead to
results that are simply non-sense? Maybe. Anyhow, we are
definitely glad that we did not find major artifacts.</p>
<p>Aside from noise effects, the minor deviations found in
Fig.~\ref{fig:gr_vcf_rng} (left) may result from three<br />
different sources. First, the expected behavior of <span class="math notranslate nohighlight">\(g(r) = 1\)</span>
is rigorously true only in the limit <span class="math notranslate nohighlight">\(\Delta t \rightarrow 0\)</span>,
while in practice the time step is always finite.
Second, the way how Eq.~(\ref{equs_of_motion})
is integrated also affects physical quantities such as <span class="math notranslate nohighlight">\(g(r)\)</span>.
Third, the deviations may result from correlations in random
number sequences.</p>
<p>In the present case the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> and
the integration procedure are fixed, and therefore their effect
is similar for all generators. Thus, the best we can do is to
compare the four curves in Fig.~\ref{fig:gr_vcf_rng} (right)
with one another. This comparison leads to a simple conclusion
that all generators yield approximately similar results within
error bars. Only R89 deviates from other generators at small <span class="math notranslate nohighlight">\(r\)</span>,
and even in this case the fluctuations are rather weak.</p>
<p>To complement this test, we also calculated the isothermal
compressibility <span class="math notranslate nohighlight">\(\kappa_T\)</span> defined as <span class="math notranslate nohighlight">\(\kappa_T \rho k_\mathrm{B} T = 
1 + 4 \pi \rho \int_0^{\infty} dr \, r^2 [ g(r) - 1 ] \)</span>,
which is an example of a thermodynamic response function.
Results of all generators were found to be very similar.
Finally, we used the single-particle velocity correlation
function <span class="math notranslate nohighlight">\(C(t) = \langle \vec{v}_i(t) \cdot \vec{v}_i(0) \rangle\)</span>
\cite{Mar76} to gauge possible problems with time-dependent
quantities such as diffusion. These studies revealed that the
results of all generators for <span class="math notranslate nohighlight">\(C(t)\)</span> were essentially identical
[see Fig.~\ref{fig:gr_vcf_rng} (right)].</p>
<p>The present results suggest that DPD model simulations are
relatively insensitive to the underlying correlations in
pseudorandom number sequences. This idea is supported by
further calculations using rather poor generators
(such as the GFSR generator <span class="math notranslate nohighlight">\(x_n = x_{n-31} \oplus x_{n-3}\)</span>),
whose results were comparable to those discussed above.
However, we cannot conclude
that this finding is generic, since the test results
depend on how random numbers are used within a simulation.
In the present case, we feel that the fluid-like
nature of the system plays certain role. Namely, as was described
in Sect.~\ref{Sec:dpdmodel}, the motion of the particle <code class="docutils literal notranslate"><span class="pre">$i$''</span>&#160; <span class="pre">is</span> <span class="pre">influenced</span> <span class="pre">by</span> <span class="pre">random</span> <span class="pre">forces</span> <span class="pre">acting</span> <span class="pre">between</span> </code><span class="math notranslate nohighlight">\(i\)</span>’’ and other
neighboring particles nearby. Since the number of neighboring
particles <span class="math notranslate nohighlight">\(K\)</span> is usually small and not conserved, the motion
of the particle ``<span class="math notranslate nohighlight">\(i\)</span>’’ is dictated by a short random
number sequence <span class="math notranslate nohighlight">\(\{ x_i \} = x_1, \ldots, x_K\)</span>, whose size
<span class="math notranslate nohighlight">\(K\)</span> fluctuates in time. Furthermore, the random number sequences
<span class="math notranslate nohighlight">\(\{ x_i \}^{(1)} = x_1, \ldots, x_{K_1}\)</span> and
<span class="math notranslate nohighlight">\(\{ x_i \}^{(2)} = x_{1+L}, \ldots, x_{K_2 + L}\)</span> used at
consecutive moments for the same particle are separated
by a sequence of size <span class="math notranslate nohighlight">\(L \sim {\cal O}(N\langle K \rangle)\)</span>.
Thus, to conclude, it seems plausible that only
strong, short-range correlations within <span class="math notranslate nohighlight">\(\{ x_i \}\)</span> influence
the dynamics of simple fluid systems that have been considered
in this work.</p>
<p>We found above that the quality of pseudorandom numbers is
likely not crucial in DPD model simulations of simple fluid
systems. This favourable idea should be taken with a grain
of salt, however. A number of simulation studies have shown
\cite{Vat99,Fer92,Sou98} that the underlying
correlations in pseudorandom number sequences may interfere
with the true dynamics of model systems. Therefore it is
possible that the same problems are lurking behind the shadows
and could be faced in DPD simulations, too. An example of such
a situation are DPD simulations in a parallel environment,
where pseudorandom number sequences can be used in various
different ways (such as the leap-frog and blocking techniques,
to name just two examples). This warrants particular care to
be taken when pseudorandom number generators are being
used in future large-scale applications. While such tests
have not been carried out yet (to our knowledge), they
would be highly welcome to clarify this issue.</p>
<p>\subsubsection{Discussion on the future aspects of using
pseudorandom numbers
\label{sect:disc_pseudorandom}}</p>
<p>The Buffon experiment \cite{Ham64} is probably one of the first
and best known examples of the Monte Carlo method. In this
experiment, one throws needles of equal length at random over
a plane marked with parallel and equidistant lines. By counting
the number of intersections between lines and needles, one can
estimate the value of <span class="math notranslate nohighlight">\(\pi\)</span>. Provided that the needles were
thrown by a pseudorandom number generator, how precise and
``universal’’ values for <span class="math notranslate nohighlight">\(\pi\)</span> would you expect?</p>
<p>If your answer is positive and in favour of using pseudorandom
number generators without any concern, perhaps a few practical
examples might change your mind. In the late 1980’s, it was
found \cite{Par85} that the critical exponents in the 3D Ising
model depended on the random number generator used in the
Monte Carlo simulations. Later in the 1990’s, Ferrenberg et al.
\cite{Fer92} draw the same conclusion in the 2D Ising model when
one employed cluster algorithms for the dynamics of the system.
Similar findings in other contexts are numerous and include,
e.g., studies of surface growth, deposition
problems, and random walks \cite{Vat94,Sou98,Res98}.</p>
<p>The above examples demonstrate that in stochastic simulation
techniques there is an extra degree of freedom that should
always be mentioned when the results are reported in the literature:
the pseudorandom number generator. This may sound sarcastic, but
the fact is that the results of stochastic simulations are
a function of the pseudorandom number generator used.</p>
<p>Consequently, numerous test methods have been developed with
an aim to find (undesired) correlation effects from the pseudorandom
number sequences. The standard tests that focus on general
properties of random number sequences form the most significant
test bench in this field \cite{Knu98}. They are complemented by
more specific tests, often known as application specific tests
\cite{Vat94,Vat95} that are designed to mimic some
particular application. Then, for research topics
such as surface growth or surface diffusion using lattice-gas
models, the Ising model is one of the most convinient starting points
when one aims to develop an application speficic test for these
purposes. Besides these, theoretical tests such as the spectral
test and discrepancy complement our knowledge of the properties
of pseudorandom number {\it algorithms}. In all, there is a huge
body of tests available. The key issue is to use them and further
to develop new test methods for ever increasing requirements.
When done carefully, one can avoid undesired artifacts
due to the pseudorandom number generator used.</p>
<p>We have demonstrated above how correlations
in some commonly used pseudorandom number generators may change the
behavior of physical quantities such as time-dependent correlation
functions. On the other hand, we have also found that some recently
suggested generators such as the Mersenne Twister and RANLUX4
passed all the present tests. A pessimist could now say that all
pseudorandom number generators have inherent weaknesses, and
eventually they fail anyway. Optimistically speaking, however,
one can conclude that there are still many generators whose
properties are reasonably good even for very challenging
applications. To make sure that the situation will remain equally
positive in the future as the computational power is increased,
further work is definitely called for to develop more reliable
pseudorandom number generators. When combined with novel test
methods to challenge them, we are on the right track.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "firasm/jupyterbook_course_template",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./class/week03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Karttunen<br/>
        
          <div class="extra_footer">
            <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>