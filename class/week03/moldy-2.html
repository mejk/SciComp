
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>What is Molecular Dynamics (MD) &#8212; SciComp9502B</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_layouts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/save_state.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://mejk.github.io/CHEM3300G/class/week03/moldy-2.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mejk.github.io/CHEM3300G/class/week03/moldy-2.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="What is Molecular Dynamics (MD)" />
<meta property="og:description" content="What is Molecular Dynamics (MD)  Learning goals:  To learn some basic terminology  Keywords: Atomistic simulations, Molecular dynamics, Monte Carlo, molecular t" />
<meta property="og:image"       content="https://mejk.github.io/CHEM3300G/_static/logo-scicomp.svg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo-scicomp.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SciComp9502B</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/syllabus.html">
   Scientific Computing - SciComp9505B
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/Linux-basics.html">
   1. Linux - the basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/linux-basic-commands-2.html">
   2. Linux: Some basic &amp; useful commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-intro.html">
   3. Brief introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week01/hpc-intro.html">
   4. Background on computers, computing and High Performance Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_numbers.html">
   5. Random numbers
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/coding-notes-general.html">
   1. On computation and codes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Installation instructions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/install-wsl.html">
   1. Installation of tools: WSL2/Linux etc.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-installation.html">
   2. Installation of Python and Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/python-virtual-environment.html">
   3. Python virtual environments
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  How-tos
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/jupyter-intro.html">
   1. Jupyter Notebook / Jupyter Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/vi-editor.html">
   2. The
   <code class="docutils literal notranslate">
    <span class="pre">
     vi
    </span>
   </code>
   editor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/editing-ascii.html">
   3. Editing ASCII files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/helpful-software.html">
   4. Helpful software
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More on computers / help
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff/blob/master/ssh-keys.md">
   ssh keys, aliases and connecting using ssh keys
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff">
   Random notes on computers, installation, dual boot, vnc, etc.
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/class/week03/moldy-2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow-in-md-simulations">
   Workflow in MD simulations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#md-workflow-refined">
   MD workflow refined
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integration-of-the-equations-of-motion">
     Integration of the equations of motion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boundary-conditions">
     Boundary conditions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-image-convention">
       Minimum image convention
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initialization">
       Initialization
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-minimization-vs-equilibration-vs-production-simulation">
     Energy minimization vs equilibration vs production simulation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initial-velocities">
       Initial velocities
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integration-finite-differences">
     Integration: finite differences
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cut-off-radius">
     Cut-off radius
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#thermodynamic-ensembles">
     Thermodynamic ensembles
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#thermostats">
       Thermostats
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#barostats">
       Barostats
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-concepts-hamiltonian">
   Basic concepts: Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-concepts-statistical-mechanics">
   Basic concepts: Statistical mechanics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-space">
     Phase space
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#force-fields">
   Force fields
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molecular-interactions-bonded-and-non-bonded">
     Molecular interactions: Bonded and non-bonded
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactions-between-unlike-atoms-lorentz-berthelot-rules">
     Interactions between unlike atoms: Lorentz-Berthelot rules
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boundary-conditions-open-closed-and-periodic">
   Boundary conditions: Open, closed and periodic
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-minimization">
     Energy minimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-equilibration">
     Pre-equilibration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equilibration">
     Equilibration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#production-run">
     Production run
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trajectory-data-analysis">
     Trajectory / data analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-and-molar-masses">
   Atomic and molar masses
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#historical-notes">
     Historical notes:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-estimate-the-number-of-molecules-and-box-size">
     How to estimate the number of molecules and box size
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-estimate-for-the-number-of-water-molecules-and-the-size-of-the-simulation-box">
       Example: Estimate for the number of water molecules and the size of the simulation box
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="what-is-molecular-dynamics-md">
<h1>What is Molecular Dynamics (MD)<a class="headerlink" href="#what-is-molecular-dynamics-md" title="Permalink to this headline">¶</a></h1>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-body docutils">
<p class="card-text"><strong>Learning goals:</strong></p>
<ul class="simple">
<li><p class="card-text">To learn some basic terminology</p></li>
</ul>
<p class="card-text"><strong>Keywords:</strong> Atomistic simulations, Molecular dynamics, Monte Carlo, molecular topology, force field, interactions</p>
<!--
**Associated material:** Cheat sheet of the most common Linux commands.
-->
</div>
</div>
</div>
</div>
</div>
<p>Now it is time to discuss some of the basic concepts of MD.
As this is the first description, it  does not aim to be complete, but rather practical in the sense that basic concepts and terminology is introduced. The aim is that this knowledge helps us to start analyzing some data and setting up simulations. These concepts (as we well as several new ones) will be elaborated as we progress.</p>
<div class="section" id="workflow-in-md-simulations">
<h2>Workflow in MD simulations<a class="headerlink" href="#workflow-in-md-simulations" title="Permalink to this headline">¶</a></h2>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<div class="figure align-left" id="heart">
<a class="reference internal image-reference" href="../../_images/molecular-simulation-workflow-simplified.svg"><img alt="../../_images/molecular-simulation-workflow-simplified.svg" src="../../_images/molecular-simulation-workflow-simplified.svg" width="750px" /></a>
<p class="caption"><span class="caption-text"><em>General MD workflow independent of software. First, one must define the components, that is, the atoms and molecules and their interactions. The atoms and molecules are then used to create the simulation system. After the simulation system has undergone relaxation and pre-equilibration, the actual MD simulation can be started. The simulation produces a trajectory - the coordinates (velocities and forces can be also saved) of all of the particles as a function of time. This trajectory is used for data analysis.</em></span><a class="headerlink" href="#heart" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="md-workflow-refined">
<h2>MD workflow refined<a class="headerlink" href="#md-workflow-refined" title="Permalink to this headline">¶</a></h2>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<div class="figure align-left" id="id1">
<a class="reference internal image-reference" href="../../_images/molecular-simulation-workflow.svg"><img alt="../../_images/molecular-simulation-workflow.svg" src="../../_images/molecular-simulation-workflow.svg" width="750px" /></a>
<p class="caption"><span class="caption-text"><em>General MD workflow independent of software. The different colors and blocks indicate the structure: First, one must define the components, that is, the atoms and molecules and their interactions. If we only individual atoms, then the topology, or connectedness is simple: there is none and the interactions between the atoms are <em>non-bonded</em>. In molecules, the atoms composing a molecule are connected and we must describe the their connectedness. This is involves numbering the atoms in a systematic way and providing information about how they are connected. This gives rise to <em>bonded</em> interactions. The force field, that is, the description of all interactions and parameters, and topology define the molecules. When a system is composed, one also needs to provide the initial coordinates.</em></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="integration-of-the-equations-of-motion">
<h3>Integration of the equations of motion<a class="headerlink" href="#integration-of-the-equations-of-motion" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="boundary-conditions">
<h3>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>Impractical to contain system with a real boundary
Enhances finite-size effects
Artificial influence of boundary on system properties</p>
<p>Instead surround with replicas of simulated system
“Periodic Boundary Conditions” (PBC)</p>
<p>Problems:</p>
<p>Correlations
new artificial correlations
supressed long-range correlations</p>
<p>Other geometries possible
any space-filling unit cell
hexagonal in 2D
truncated octahedron in 3D
rhombic dodecahedron in 3D
surface of a (hyper)sphere
variable aspect ratio useful for solids
relieves artificial stresses</p>
<div class="section" id="minimum-image-convention">
<h4>Minimum image convention<a class="headerlink" href="#minimum-image-convention" title="Permalink to this headline">¶</a></h4>
<p>Minimum image convention</p>
<p>Consider only nearest image of a given particle when looking for collision partners</p>
</div>
<div class="section" id="initialization">
<h4>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h4>
<p>The system needs to be set up before the actual simulation can start. Assuming that a force field has been chosen, one needs to set up the simulation system. 1) This means assembling the system in a simulation box and 2) choosing the boundary conditions. The first part involves assigning initial coordinates for the atom and molecules. There are several possibilities for doing that. What is the most appropriate method depends on the system. For example: To create a system resembling a liquid or a gas, random generation of coordinates may be a good choice whereas for a solid-state system one may want to choose a lattice. For protein simulations, the most convenient choice may be to download a PDB file from the PDB database (PDB files have molecular coordinates). Such data may come, for example, from X-ray diffraction or NMR. Similarly, one may generate the homology models based on experimental data and use the initial coordinates from one/some of the homology model(s). Finally, a very common choice is to use coordinates data from a previous simulation.</p>
</div>
</div>
<div class="section" id="energy-minimization-vs-equilibration-vs-production-simulation">
<h3>Energy minimization vs equilibration vs production simulation<a class="headerlink" href="#energy-minimization-vs-equilibration-vs-production-simulation" title="Permalink to this headline">¶</a></h3>
<p>There is an often overlooked major difference between integration of the equations of motion and energy minimization: Integration is the propagation of the equations of motion in time with a time step given in terms of real time. Thus, it involves updates of the particles’ positions and velocities.     Energy minimization using <a class="reference external" href="https://en.wikipedia.org/wiki/Method_of_steepest_descent">steepest descents</a> or the <a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">conjugate gradient</a> method is a mathematical (deterministic) optimization process that involves minimization of the potential energy, that is, only positions are needed. Second, even though ones gives a number of steps for the optimization process, the number of steps does not correspond to physical time but only gives an upper limit for the number of steps to be taken in case the process doesn’t converge earlier. We will not discuss these methods in detail here, but it is important to understand that optimization using these methods does not involve time or velocities, it is simply minimization of the potential energy. This is a general feature of these methods are not specific to Gromacs or any other simulation/modeling package.</p>
<p><strong>Further considerations:</strong></p>
<ol class="simple">
<li><p>If one has to assemble a system consisting of several different molecules, it is usually a good idea to start from the largest molecule first. For example, take the protein and put in the simulation box. After that, solvate the system with water molecules and add the ions (if needed) last.</p></li>
<li><p>If one continues one’s own previous simulation of the same system, then one can jump directly to the production phase and the time is continued from the end of the previous simulations. Most software provide mechanisms for that</p></li>
<li><p>It is generally a good idea to use a previous simulation as a starting point since it has been already run for possibly a long time. It may still be a good idea to go through the equilibration phase and double-check that the system is indeed in equilibrium.</p></li>
</ol>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<div class="figure align-left" id="init">
<a class="reference internal image-reference" href="../../_images/molecular-simulation-initialization.svg"><img alt="../../_images/molecular-simulation-initialization.svg" src="../../_images/molecular-simulation-initialization.svg" width="750px" /></a>
<p class="caption"><span class="caption-text">Energy minimization, pre-equilibration (or relaxation), equilibration, production</span><a class="headerlink" href="#init" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="initial-velocities">
<h4>Initial velocities<a class="headerlink" href="#initial-velocities" title="Permalink to this headline">¶</a></h4>
<p>Random direction
randomize each component independently
randomize direction by choosing point on spherical surface</p>
<p>Magnitude consistent with desired temperature.  Choices:</p>
<p>Maxwell-Boltzmann:
Uniform over (-1/2,+1/2), then scale so that
Same for y, z components</p>
<p>Be sure to shift so center-of-mass momentum is zero</p>
</div>
</div>
<div class="section" id="integration-finite-differences">
<h3>Integration: finite differences<a class="headerlink" href="#integration-finite-differences" title="Permalink to this headline">¶</a></h3>
<p>Criteria:
it should be simple; easy to write and to debug
it should be stable; energy conservation
it should be efficient; how fast it can advance the system
it should be reliable; can it handle temperatures, pressures, densities
special properties; does it vectorize, etc.</p>
<p>Other factors:
Almost all of the CPU time goes into computing the forces
Memory consideration are not a major issue nowadays. However, one should beware of cache misses (what is a cache miss?)
it should be efficient; how fast it can advance the system
Energy conservation is important. The (constant) energy surface becomes a little bit rough is energy is not conserved. Rule of thumb (Ceperley): allow 0.01kT fluctuation in the total energy.
Other symmetries, such as momentum conservation may be important</p>
<p>Unnecessary for Monte Carlo simulations (of course)</p>
</div>
<div class="section" id="cut-off-radius">
<h3>Cut-off radius<a class="headerlink" href="#cut-off-radius" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="thermodynamic-ensembles">
<h3>Thermodynamic ensembles<a class="headerlink" href="#thermodynamic-ensembles" title="Permalink to this headline">¶</a></h3>
<div class="section" id="thermostats">
<h4>Thermostats<a class="headerlink" href="#thermostats" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="barostats">
<h4>Barostats<a class="headerlink" href="#barostats" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="basic-concepts-hamiltonian">
<h2>Basic concepts: Hamiltonian<a class="headerlink" href="#basic-concepts-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>Typically, the system is described by a model Hamiltonian that depends on the degrees of freedom the system has.</p>
<p>The Hamiltonian expresses the total energy of an isolates system as a function of coordinates &amp; momenta.</p>
<div class="amsmath math notranslate nohighlight" id="equation-715af49f-f832-47e6-950b-1da6f13ed15d">
<span class="eqno">()<a class="headerlink" href="#equation-715af49f-f832-47e6-950b-1da6f13ed15d" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathcal{H} \equiv \mathcal{H}(\vec{q}, \vec{p})
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-b13abbe4-9a10-4338-ac9c-90430820fb32">
<span class="eqno">()<a class="headerlink" href="#equation-b13abbe4-9a10-4338-ac9c-90430820fb32" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathcal{H} = T +V
\end{equation}\]</div>
</div>
<div class="section" id="basic-concepts-statistical-mechanics">
<h2>Basic concepts: Statistical mechanics<a class="headerlink" href="#basic-concepts-statistical-mechanics" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>The object of statistical mechanics is to provide a molecular theory or interpretation of equilibrium properties of macroscopic systems.</p>
<p class="attribution">—T.L. Hill</p>
</div></blockquote>
<p>It answers the question “why?” in thermodynamics.</p>
<div class="section" id="phase-space">
<h3>Phase space<a class="headerlink" href="#phase-space" title="Permalink to this headline">¶</a></h3>
<p>The  Hamiltonian depends on the degrees of freedom the system has, i.e.,</p>
<p>The set of states constitutes the phase space available for the system.</p>
<p>Any observable quantity is a function of the states of the system. For the accessible states, there is a distribution function.</p>
<p>Any observable quantity is a function of the states of the system. For the accessible states, there is a distribution function. Now, a quantity A is given as an expectation value by</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle = \frac{1}{Z} 
\int 
A(\vec{q}, \vec{p}) 
f( \mathcal{H}(\vec{q}, \vec{p})) \,
d\vec{q}^N \, d\vec{p}^N
\]</div>
<p>is called the ensemble average, where Z, the partition function, is defined as</p>
<div class="math notranslate nohighlight">
\[
Z = \int f( \mathcal{H}(\vec{q}, \vec{p})) \,
d\vec{q}^N \, d\vec{p}^N
\]</div>
<p>Interpretation of the ensemble average: It is the average over all possible states of the system. However, this is not how we usually make measurements. Typically, we perform measurements over some interval of time and then compute the average over these measurements.
This procedure is typical for both simulation and experiments and it is called time averaging.</p>
<p>The time average is defined as</p>
<div class="math notranslate nohighlight">
\[
\langle A \rangle_\mathrm{time} = \bar{A} = \frac{1}{t-t_0} \int_t_0^t A(t')\, dt'
\]</div>
<p>Are the time average and the ensemble average the same?</p>
<p>To be able to proceed, we invoke the ergodic hypothesis and hence assume that we can replace the ensemble average by the time average.</p>
<p>Is this a valid assumption? Does it always hold?</p>
<p>The ergodic hypothesis does not always hold. Sometimes it is a practical problem and sometimes ergodicity breaking is a fundamental property of the system.</p>
<p>What about simulations:</p>
<p>Time averaging: Molecular dynamics approach; study the evolution of the system</p>
<p>Ensemble averaging: Monte Carlo approach; sample the phase space by using different initial conditions.</p>
<p>Problems:
Glasses
Systems with metastable states
Harmonic solids
Integrable systems</p>
</div>
</div>
<div class="section" id="force-fields">
<h2>Force fields<a class="headerlink" href="#force-fields" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>If in some cataclysm all scientiﬁc knowledge were to be destroyed and only one sentence passed onto the next generation of creatures,what statement would contain the most information in the fewest words? I believe it is the atomic hypothesis that all things are made of atoms–little particles that move around in perpetual motion,attracting each other when they area little distance apart,but repelling upon being squeezed into one another. In that one sentence,you will see there is an enormous amount of information about the world, of just a little imagination and thinking is applied.</p>
<p class="attribution">—Richard Feynman in Feynman Lectures in Physics</p>
</div></blockquote>
<div class="section" id="molecular-interactions-bonded-and-non-bonded">
<h3>Molecular interactions: Bonded and non-bonded<a class="headerlink" href="#molecular-interactions-bonded-and-non-bonded" title="Permalink to this headline">¶</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-0b2b5b32-8e56-4b33-9746-020bffb76181">
<span class="eqno">()<a class="headerlink" href="#equation-0b2b5b32-8e56-4b33-9746-020bffb76181" title="Permalink to this equation">¶</a></span>\[\begin{equation} 
\frac{d \vec{p}}{dt}
= -\nabla  U(\vec{r})
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[
\frac{d\mathcal{H}}{dt}=0
\]</div>
<div class="math notranslate nohighlight">
\[
U_\mathrm{LJ} (r_{ij})= 
4 \epsilon
\left[
\left(
\frac{\sigma}{r_{ij}}
\right)^{12}
-
\left(
\frac{\sigma}{r_{ij}}
\right)^{6}
\right]
\]</div>
<div class="math notranslate nohighlight">
\[
U_\mathrm{LJ} (r_{ij})= 
\left(
\frac{A}{r_{ij}}
\right)^{12}
-
\left(
\frac{B}{r_{ij}}
\right)^{6}
\]</div>
</div>
<div class="section" id="interactions-between-unlike-atoms-lorentz-berthelot-rules">
<h3>Interactions between unlike atoms: Lorentz-Berthelot rules<a class="headerlink" href="#interactions-between-unlike-atoms-lorentz-berthelot-rules" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[
\sigma_{ij} = \frac{\sigma_i + \sigma_j}{2}
\]</div>
<div class="math notranslate nohighlight">
\[
\epsilon_{ij} = \sqrt{\epsilon_i \epsilon_j}
\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-793fc9c4-d6b0-4595-9d94-9522818b22ca">
<span class="eqno">()<a class="headerlink" href="#equation-793fc9c4-d6b0-4595-9d94-9522818b22ca" title="Permalink to this equation">¶</a></span>\[\begin{equation} 
V = \sum_{i} U_1(\vec{r}_i) + 
    \sum_{i} \sum_{j &gt; i} U_2(\vec{r}_i,\vec{r}_j) + 
    \sum_{i} \sum_{j &gt; i} \sum_{k &gt; j &gt; i} 
         U_3(\vec{r}_i,\vec{r}_j,\vec{r}_k) + \mathrm{higher\,\,order\,\, terms}. 
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-a3462134-690a-49f4-994e-9bb9b81fa13f">
<span class="eqno">()<a class="headerlink" href="#equation-a3462134-690a-49f4-994e-9bb9b81fa13f" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray} 
\label{eq:forcefield}
V &amp; = &amp; \sum_{\mathrm{bonds}} 
    \frac{k_i^\mathrm{b}}{2}(l_i - l_i^{\mathrm{ref}})^2 +
    \sum_{\mathrm{angles}}\frac{k_i^\mathrm{a}}{2}
         (\theta_i - \theta_i^{\mathrm{ref}})^2 +
    \sum_{\mathrm{torsions}}\frac{V_T}{2}
         (1 + \cos(n\omega - \gamma)) + \\ \nonumber 
  &amp; &amp;  \sum_{i=1}^{N-1} \sum_{j=i+1}^{N} 
      \left( 4\epsilon_{ij}
          \left[ 
             \left( \frac{\sigma_{ij}}{r_{ij}}\right)^{12} - 
             \left( \frac{\sigma_{ij}}{r_{ij}}\right)^6 
          \right] + 
          \frac{q_i q_j}{4\pi \epsilon_0 r_{ij}}
      \right)  . 
\end{eqnarray}\]</div>
</div>
</div>
<div class="section" id="boundary-conditions-open-closed-and-periodic">
<h2>Boundary conditions: Open, closed and periodic<a class="headerlink" href="#boundary-conditions-open-closed-and-periodic" title="Permalink to this headline">¶</a></h2>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<div class="figure align-left" id="id2">
<a class="reference internal image-reference" href="../../_images/boundary-conditions-demonstrated.svg"><img alt="../../_images/boundary-conditions-demonstrated.svg" src="../../_images/boundary-conditions-demonstrated.svg" width="750px" /></a>
<p class="caption"><span class="caption-text">The most common boundary conditions. Left: Open boundary. The particles a free to move anywhere in space without limitations. Middle: Particles in a box with walls. Here, hard walls are assumed meaning the particles undergo elastic collisions and are reflected back from the boundary. Right: Periodic boundaries. In this case there is no physical wall, but since the system is periodic (not open), the particles have to be wrapped back into the box when they cross the  border.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<div class="figure align-left" id="id3">
<a class="reference internal image-reference" href="../../_images/pbc.svg"><img alt="../../_images/pbc.svg" src="../../_images/pbc.svg" width="750px" /></a>
<p class="caption"><span class="caption-text">General MD workflow.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="energy-minimization">
<h3>Energy minimization<a class="headerlink" href="#energy-minimization" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="pre-equilibration">
<h3>Pre-equilibration<a class="headerlink" href="#pre-equilibration" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="equilibration">
<h3>Equilibration<a class="headerlink" href="#equilibration" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="production-run">
<h3>Production run<a class="headerlink" href="#production-run" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="trajectory-data-analysis">
<h3>Trajectory / data analysis<a class="headerlink" href="#trajectory-data-analysis" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="atomic-and-molar-masses">
<h2>Atomic and molar masses<a class="headerlink" href="#atomic-and-molar-masses" title="Permalink to this headline">¶</a></h2>
<p>When we set up MD simulations, we need to have estimates, for example, for the size of the simulation box, the number of molecules and the types of molecules. This may be sometimes difficult, but it is easy to get a reasonable estimate and for that atomic and molar masses are needed. As reminder, let’s review the concept of mole and its relation to the mass of a an atom:</p>
<div class="sphinx-bs fluid docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text"><strong>Chemical notation</strong></p>
</div>
<div class="card-body docutils">
<p class="card-text"><span class="math notranslate nohighlight">\(^{12}\)</span>C = 1 mole of <span class="math notranslate nohighlight">\(^{12}\)</span>C</p>
<p class="card-text">Using the old (pre-2019) definition, the atomic mass of <span class="math notranslate nohighlight">\(^{12}\)</span>C is 12 amu. Hence
[mass in amu] = 12. That is, one mole of <span class="math notranslate nohighlight">\(^{12}\)</span>C has the atomic mass of 12.
To get the mass of a <span class="math notranslate nohighlight">\(^{12}\)</span>C atom, we have to divide by Avogadro’s number:</p>
<div class="math notranslate nohighlight">
\[
 m_\mathrm{^{12}\mathrm{C}} = \frac{12} {6.0221 \times 10^{23}}\, \mathrm{g} \approx 
 1.993 \times 10^{-23} \, \mathrm{g} =  1.993 \times 10^{-26} \, \mathrm{kg} 
 \]</div>
</div>
</div>
</div>
</div>
</div>
<P></p>
<div class="section" id="historical-notes">
<h3>Historical notes:<a class="headerlink" href="#historical-notes" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Avogadro_constant">Avogadro’s number</a> is named after <a class="reference external" href="https://en.wikipedia.org/wiki/Amedeo_Avogadro">Amadeo Avogadro</a>, an Italian scientist (who started out as a lawyer). Avogadro’s number was originally proposed by <a class="reference external" href="https://en.wikipedia.org/wiki/Jean_Baptiste_Perrin">Jean Perrin</a> who was also the first to determine it and was awarded the <a class="reference external" href="https://www.nobelprize.org/prizes/physics/1926/perrin/biographical/">Nobel Prize in Physics in 1926</a>. Avogadro studied gases and proposed that under given thermodynamic conditions, the volume is proportional to the constituents of that gas <em>independent</em> of the precise nature of that gas. In earlier German literature, Avogadro’s number has the name <a class="reference external" href="https://en.wikipedia.org/wiki/Loschmidt_constant">Loschmidt number</a>.</p>
<p>The first standard was the mass of the hydrogen atom (<a class="reference external" href="https://en.wikipedia.org/wiki/Stanislao_Cannizzaro">Stanislao Cannizzarro</a>). The problem with this was the lightness of hydrogen which lead to large experimental errors (Perrin also used the hydrogen mass standard). In 1903, the German Chemical Society (Deutsche Chemische Gesellschaft) set the <span class="math notranslate nohighlight">\(^{16}\)</span>O scale.</p>
</div>
<div class="section" id="how-to-estimate-the-number-of-molecules-and-box-size">
<h3>How to estimate the number of molecules and box size<a class="headerlink" href="#how-to-estimate-the-number-of-molecules-and-box-size" title="Permalink to this headline">¶</a></h3>
<p>The mole (mol) is defined as the amount of substance that contains Avogadro’s number (<span class="math notranslate nohighlight">\(N_A\)</span>) of constitutive particles (<span class="math notranslate nohighlight">\(N_A \approx 6.0221 \times 10^{23}\,\mathrm{mol}^{-1}\)</span>). The constitutive particles may be molecules or atoms. Importantly, <span class="math notranslate nohighlight">\(N_A\)</span> makes no reference to the their precise nature. The mole is one of the seven SI base units. The older, pre-2019, definition of mole is that it is the amount of chemical substance (atoms, molecules) contained in 12 grams of <span class="math notranslate nohighlight">\(^{12}\)</span>C. The molar mass is defined as mass (typically grams) divided by the amount of substance (in moles). It is thus given in units of g/mol. With this, the unified atomic mass unit can be defined as</p>
<div class="math notranslate nohighlight">
\[
1\,\mathrm{u} = 
\frac{\mathrm{molar\,mass\,constant}}{\mathrm{Avogadro's\, constant}} =
\frac{M_\mathrm{u}}{N_\mathrm{A}} \approx 
\frac{1\,\mathrm{g/mol}}{6.022\times 10^{23}\,\mathrm{mol}^{-1}} =
1.661 \times 10^{-24}\,\mathrm{g} =
1\,\mathrm{Dalton} = 1\,\mathrm{Da},
\]</div>
<p>where <span class="math notranslate nohighlight">\(M_\mathrm{u}\)</span>  is the molar mass constant. In the above, we gave the unified atomic mass in grams since that is the common notation although kilogram would be the more appropriate unit as it is one of the base SI units. In addition, it is good to keep in mind that the atomic radii are about 1 Å while the nuclear radius is about <span class="math notranslate nohighlight">\(10^{-5}\)</span> Å.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>Additional information: SI Units</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">The seven SI base units:</p>
<table class="table" id="si-units">
<caption><span class="caption-text">SI units and the defining constants</span><a class="headerlink" href="#si-units" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p class="card-text">quantity</p></th>
<th class="head"><p class="card-text">name</p></th>
<th class="head"><p class="card-text">symbol</p></th>
<th class="head"><p class="card-text">defining constant</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="card-text">time</p></td>
<td><p class="card-text">second</p></td>
<td><p class="card-text">s</p></td>
<td><p class="card-text">hyperfine transition frequency of cesium</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">length</p></td>
<td><p class="card-text">meter</p></td>
<td><p class="card-text">m</p></td>
<td><p class="card-text">speed of light</p></td>
</tr>
<tr class="row-even"><td><p class="card-text">mass</p></td>
<td><p class="card-text">kilogram</p></td>
<td><p class="card-text">kg</p></td>
<td><p class="card-text">Planck’s constant</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">temperature</p></td>
<td><p class="card-text">kelvin</p></td>
<td><p class="card-text">K</p></td>
<td><p class="card-text">Boltzmann’s constant</p></td>
</tr>
<tr class="row-even"><td><p class="card-text">amount of substance</p></td>
<td><p class="card-text">mole</p></td>
<td><p class="card-text">mol</p></td>
<td><p class="card-text">Avogadro’s constant</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">electric current</p></td>
<td><p class="card-text">ampere</p></td>
<td><p class="card-text">A</p></td>
<td><p class="card-text">elementary charge</p></td>
</tr>
<tr class="row-even"><td><p class="card-text">luminous intensity</p></td>
<td><p class="card-text">candela</p></td>
<td><p class="card-text">cd</p></td>
<td><p class="card-text">luminous efficacy of 540 THz radiation</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p class="card-text">More information: <a class="reference external" href="https://en.wikipedia.org/wiki/International_System_of_Units">International System of Units (SI)</a></p></li>
</ul>
</div>
</details><div class="section" id="example-estimate-for-the-number-of-water-molecules-and-the-size-of-the-simulation-box">
<h4>Example: Estimate for the number of water molecules and the size of the simulation box<a class="headerlink" href="#example-estimate-for-the-number-of-water-molecules-and-the-size-of-the-simulation-box" title="Permalink to this headline">¶</a></h4>
<p>The above formulas can now be used to estimate the number of water molecules and the size for the simulation box.</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 docutils">
<div class="card-body docutils">
<p class="card-text"><strong>Step 1:</strong> Determine the weight of the molecule in grams. For that, its mass in unified atomic mass is needed together with Avogadro’s constant:</p>
<div class="math notranslate nohighlight">
\[
m_\mathrm{molecule} =
\frac{
 \mathrm{mass\,in\,u}
}
 {N_\mathrm{A}}\, \mathrm{g} 
=
\frac{
 \mathrm{mass\,in\,u}
} 
{(6.0221 \times 10^{23})}
\, \mathrm{g} 
\]</div>
<p class="card-text"><strong>Step 2:</strong> We need to have some approximate density (<span class="math notranslate nohighlight">\(\rho\)</span>) and number of molecules (<span class="math notranslate nohighlight">\(N_\mathrm{molecule\)</span>}). Since the simulation box is in nanometers, we should convert this to grams/nanometers: <span class="math notranslate nohighlight">\(1\,\mathrm{g/cm^3} = 10^{-21}\,\mathrm{g/nm^3}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathrm{density\,in\,grams/nm^3} =
\frac
{\mathrm{mass\,in\,grams}}
{\mathrm{volume\,in\, nm^3}}
= \frac
{N_\mathrm{molecule} \times m_\mathrm{molecule}}
{\mathrm{volume\,in\, nm^3}}
\]</div>
<p class="card-text"><strong>Step 3:</strong> Solve for volume and assume that the simulation box is cubic</p>
<div class="math notranslate nohighlight">
\[
{\mathrm{volume\,in\, nm^3}}
= \frac
{N_\mathrm{molecule} \times m_\mathrm{molecule}}
{\mathrm{density\,in\,grams/nm^3}}
=
\frac
{N_\mathrm{molecule} \times m_\mathrm{molecule}}
{\rho \times 10^{-21}}
%}
\,
\mathrm{nm}^3
\]</div>
<p class="card-text">This gives the very useful formula for the simulation box size:</p>
<div class="math notranslate nohighlight">
\[
L = \sqrt[3]{\frac{N_\mathrm{molecule} \times m_\mathrm{molecule}}
{\rho \times 10^{-21}}}.
\]</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>Task: Estimate the simulation box size for a given number of water molecules:</strong></p>
<p>Use the above to estimate the (cubic) box size that is needed for 3,000 water molecules. Try to solve this first on your own before seeing the solution.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>Solution:</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text"><strong>Step 1:</strong> The unified atomic mass of water (using table values for the unified atomic masses of hydrogen (1.008 u) and oxygen (15.9994 u)) is</p>
<div class="math notranslate nohighlight">
\[
(15.994 + 2 \times 1.008) \, \mathrm{u} 
= 
18.0154 \, \mathrm{u}
\]</div>
<p class="card-text">With this the molar mass is</p>
<div class="math notranslate nohighlight">
\[
M(\mathrm{H_2O}) = (15.994 + 2 \times 1.008) \, \mathrm{g/mol} 
= 
18.0154 \, \mathrm{g/mol}
\]</div>
<p class="card-text">To get the weight of a water molecule in grams, we have to divide by Avogadro’s constant:</p>
<div class="math notranslate nohighlight">
\[
m_\mathrm{H_2O} = 18.0154 /(6.0221 \times 10^{23})\, \mathrm{g} \approx 2.9915 \times 10^{-23} \, \mathrm{g}
\]</div>
<p class="card-text"><strong>Step 2:</strong> The density of water is approximately <span class="math notranslate nohighlight">\(1\,\mathrm{g/cm^3}\)</span>. We have 3,000 water molecules.</p>
<p class="card-text"><strong>Step 3:</strong> Use the formula</p>
<div class="math notranslate nohighlight">
\[
L=\sqrt[3]{
\frac
{N_\mathrm{H_2O} \times m_\mathrm{H_2O}}
{\rho \times 10^{-21}}
}
\,
\mathrm{nm}
\]</div>
<p class="card-text">Substitution gives</p>
<div class="math notranslate nohighlight">
\[
\underline{
\underline{
L=\sqrt[3]{
\frac{
3000 \times 2.9915 \times 10^{-23}
}
{
10^{-21}
}
} \,\mathrm{nm}
=\sqrt[3]{3000 \times  0.029915} \,\mathrm{nm}
\approx
4.48 \, \mathrm{nm}
}}
\]</div>
</div>
</details><p><strong>Gromacs notes: Number of water molecules and box size</strong></p>
<ol class="simple">
<li><p>The Gromacs unit system uses grams and nanometers so the above can be applied directly.</p></li>
<li><p>If you have no table available, Gromacs provides unified atomic masses in the file</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$GMXDATA/top/atommass.dat
</pre></div>
</div>
<p>and toward the end of the file there is an entry for water with the following values for oxygen and hydrogen (of course you can check these from elsewhere as well):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SOL</span> <span class="n">OW</span>  <span class="mf">15.9994</span>
<span class="n">SOL</span> <span class="n">HW</span>   <span class="mf">1.008</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "firasm/jupyterbook_course_template",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./class/week03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Karttunen<br/>
        
          <div class="extra_footer">
            <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>