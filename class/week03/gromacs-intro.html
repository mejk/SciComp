
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction to Gromacs &#8212; SciComp9502B</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_layouts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/save_state.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://mejk.github.io/CHEM3300G/class/week03/gromacs-intro.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mejk.github.io/CHEM3300G/class/week03/gromacs-intro.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Introduction to Gromacs" />
<meta property="og:description" content="Introduction to Gromacs  Gromacs  Learning goals:  To learn the basic structure and protocols of Gromacs  To understand that different software employ different" />
<meta property="og:image"       content="https://mejk.github.io/CHEM3300G/_static/logo-scicomp.svg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo-scicomp.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SciComp9502B</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/syllabus.html">
   Scientific Computing - SciComp9505B
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/Linux-basics.html">
   1. Linux - the basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/linux-basic-commands-2.html">
   2. Linux: Some basic &amp; useful commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-intro.html">
   3. Brief introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week01/hpc-intro.html">
   4. Background on computers, computing and High Performance Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="random_numbers.html">
   5. Random numbers
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/coding-notes-general.html">
   1. On computation and codes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Installation instructions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/install-wsl.html">
   1. Installation of tools: WSL2/Linux etc.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/python-installation.html">
   2. Installation of Python and Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/python-virtual-environment.html">
   3. Python virtual environments
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  How-tos
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week02/jupyter-intro.html">
   1. Jupyter Notebook / Jupyter Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/vi-editor.html">
   2. The
   <code class="docutils literal notranslate">
    <span class="pre">
     vi
    </span>
   </code>
   editor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/editing-ascii.html">
   3. Editing ASCII files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extras/helpful-software.html">
   4. Helpful software
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  More on computers / help
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff/blob/master/ssh-keys.md">
   ssh keys, aliases and connecting using ssh keys
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/mejk/computer-stuff">
   Random notes on computers, installation, dual boot, vnc, etc.
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/class/week03/gromacs-intro.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-gromacs">
   What is Gromacs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relation-of-gromacs-to-other-md-simulation-packages">
     Relation of Gromacs to other MD simulation packages
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-features-of-gromacs">
   Main features of Gromacs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quantum-mechanical-molecular-mechanics-calculations-qm-mm">
   Quantum mechanical / Molecular Mechanics calculations (QM/MM)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-grompp-preprocessor">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     grompp
    </span>
   </code>
   preprocessor
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-features">
   Additional features
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#free-energy-calculations">
     Free energy calculations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gromacs-unit-system">
   Gromacs unit system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#files">
   Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-gromacs">
<h1>Introduction to Gromacs<a class="headerlink" href="#introduction-to-gromacs" title="Permalink to this headline">¶</a></h1>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-body docutils">
<a class="bg-light reference internal image-reference" href="../../_images/gromacs-logo.png"><img alt="Gromacs" class="bg-light align-right" src="../../_images/gromacs-logo.png" style="width: 250px;" /></a>
<p class="card-text"><strong>Learning goals:</strong></p>
<ul class="simple">
<li><p class="card-text">To learn the basic structure and protocols of Gromacs</p></li>
<li><p class="card-text">To understand that different software employ different unit systems</p></li>
</ul>
<p class="card-text"><strong>Keywords:</strong> Gromacs, grompp, molecular dynamics, molecular topology, force field, interactions, free energy, thermostat, barostat, QM/MM, unit system, CUDA</p>
<p class="card-text"><strong>Associated material:</strong></p>
<ul class="simple">
<li><p class="card-text"><a class="reference external" href="https://manual.gromacs.org/">Full Gromacs documentation</a></p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<hr>
<div class="section" id="what-is-gromacs">
<h2>What is Gromacs<a class="headerlink" href="#what-is-gromacs" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/GROMACS">Gromacs</a> is simulation software package for classical MD simulations. Along with <a class="reference external" href="https://en.wikipedia.org/wiki/NAMD">NAMD</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/AMBER">Amber</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/LAMMPS">LAMMPS</a>, it is one of the world’s most popular MD simulation packages. Although it was originally developed for simulations of biochemical systems such as proteins, lipids and nucleic acids, it is a general purpose simulation package and has been used for nanotubes, colloids, polymers and many other systems. It has been used to simulate systems with millions of particles. Gromacs has a very rich feature set that goes far beyond what we can discuss during this course.</p>
<!--
It allows the user also to input interactions in tabular formats for generality.
-->
<p>The name Gromacs is an acronym, that stands for the <em>Groningen Machine for Chemical Simulations</em>. The development started in 1991. It was originally developed in the group of <a class="reference external" href="https://en.wikipedia.org/wiki/Herman_Berendsen">Herman Berendsen</a> at the <a class="reference external" href="https://en.wikipedia.org/wiki/University_of_Groningen">University of Groningen</a> in the Netherlands. Since around 2001, the main Gromacs development has been done at the <a class="reference external" href="https://en.wikipedia.org/wiki/KTH_Royal_Institute_of_Technology">Royal Institute of Technology</a> (Kungliga Tekniska högskolan, KTH) in Stockholm, <a class="reference external" href="https://en.wikipedia.org/wiki/Stockholm_University">Stockholm University</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Uppsala_University">Uppsala University</a>, all in Sweden. Gromacs is also part of the European Union <a class="reference external" href="https://bioexcel.eu/">BioExcel</a> (Centre of Excellence for Computational Biomolecular Research) program and it is open source. Notably, essentially all of the major simulation packages are open source.</p>
<div class="section" id="relation-of-gromacs-to-other-md-simulation-packages">
<h3>Relation of Gromacs to other MD simulation packages<a class="headerlink" href="#relation-of-gromacs-to-other-md-simulation-packages" title="Permalink to this headline">¶</a></h3>
<p>There are many excellent software packages available for classical MD simulations. Some of the most famous ones in addition to Gromacs are
<a class="reference external" href="https://en.wikipedia.org/wiki/AMBER">Amber</a> (Assisted Model Building with Energy Refinement), <a class="reference external" href="https://en.wikipedia.org/wiki/NAMD">NAMD</a> (Nanoscale Molecular Dynamics), <a class="reference external" href="https://en.wikipedia.org/wiki/CHARMM">CHARMM</a> (Chemistry at Harvard Macromolecular Mechanics), <a class="reference external" href="https://en.wikipedia.org/wiki/LAMMPS">LAMMPS</a> (Large-scale Atomic/Molecular Massively Parallel Simulator), <a class="reference external" href="https://en.wikipedia.org/wiki/GROMOS">GROMOS</a> (GROningen MOlecular Simulation; one of the oldest packages as it dates back to 1978) and <a class="reference external" href="https://www.scd.stfc.ac.uk/Pages/DL_POLY.aspx">DL-Poly</a> (not sure about the acronym, but it is likely that DL refers to <a class="reference external" href="https://stfc.ukri.org/about-us/where-we-work/daresbury-laboratory/">Daresbury Laboratory</a> where DL-Poly originated from the group of William Smith around 1993). They all have their own particular strengths and the choice depends on the task at hand, simulation conditions, force field requirements, resources and prior experience. Gromacs, NAMD, Amber and LAMMPS offer GPU acceleration which allows for simulations of moderate size systems (10,000’s of atoms) even on consumer PCs with (currently NVIDIA) graphics cards.</p>
<p>The need for a particular force field is another important criterion when choosing software. Some of the above sooftware packages are restricted to only a certain family for force fields (CHARMM and NAMD software for CHARMM family of force fields and Amber software for Amber family of force fields). One particular strength of Gromacs is that it supports a very wide range of force fields including atomistic (Amber, CHARMM, OPLS, GROMOS force field families) and coarse-grained (MARTINI). There are also user-provided patches to some versions of Gromacs that support more exotic force fields such as PLUM<a class="bibtex reference internal" href="#bereau2014" id="id1">[1]</a>. On the other hand, a package such as Amber may offer support to the very latest Amber-family force fields that are not yet availabe for other software.</p>
<p><strong>Note:</strong> When reading literature, one issue that often causes confusion is the naming of force fields and software. The names Amber, CHARMM and GROMOS can refer to either software or force field (or both). When taking about either, ones should use the software and force field version numbers as that makes the situation much clearer. This is also important from another point of view: Each of the force fields has <em>many</em> variants and it is very important to distinguish between them; to give an idea, CHARMM force fields include (and this is not a complete list) CHARMM22, CHARMM27, CHARMM36, CHARMM36m, CHARMM36 Drude, CGenFF, CHARMM27/CMAP and so on.</p>
<p><strong>More:</strong> List of software for molecular mechanics</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Comparison_of_software_for_molecular_mechanics_modeling">Comparison of software for molecular mechanics modeling</a> from Wikipedia</p></li>
<li><p>A list of <a class="reference external" href="https://en.wikipedia.org/wiki/Category:Molecular_dynamics_software">Molecular dynamics software</a> from Wikipedia</p></li>
</ul>
<p>It is important to keep in mind that there is no best choice when it comes to software. The choice depends on many factors such as one needs for some specific functionality, needs for specific force fields, available hardware and so on as discussed before. The good news is that there are a lot of excellent choices such as those mentioned above (and there is more). Here, we use Gromacs.</p>
<!--

## Main areas of use
-->
</div>
</div>
<div class="section" id="main-features-of-gromacs">
<h2>Main features of Gromacs<a class="headerlink" href="#main-features-of-gromacs" title="Permalink to this headline">¶</a></h2>
<p>Gromacs has always been known for it is very good performance, stability and its developers have always been quick to adapt new technologies such as <a class="reference external" href="https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions">SSE</a> (Streaming SIMD extensions) and <a class="reference external" href="https://en.wikipedia.org/wiki/SSE2">SSE2</a> in the early 2000’s and later <a class="reference external" href="https://en.wikipedia.org/wiki/CUDA">CUDA</a>-based GPU acceleration. From the user point of view, Gromacs is run from the command line (CLI) - this is the case with essentially all of the simulations software. Gromacs has been ported to various computer architectures and, importantly, both input and output files are <em>independent</em> of the hardware that was used to generate them. Input files are given in ASCII format (this is also the reason why we need an ASCII editor such as <code class="docutils literal notranslate"><span class="pre">vi</span></code>, <code class="docutils literal notranslate"><span class="pre">emacs</span></code>, <code class="docutils literal notranslate"><span class="pre">atom</span></code> or such to edit the input files).</p>
<p>Gromacs saves data in compressed form with two options (<code class="docutils literal notranslate"><span class="pre">.xtc</span></code> and <code class="docutils literal notranslate"><span class="pre">.trr</span></code>; we will discuss the Gromacs files in a separate section below). Gromacs also provides a very large set (&gt;100) of built-in analysis routines. The use of these routines typically require two steps:</p>
<ol class="simple">
<li><p>identification of the atoms and/or molecules of interest. This is called <em>indexing</em> and it produces and <em>index file</em> (<code class="docutils literal notranslate"><span class="pre">.ndx</span></code>). This <em>index file</em> is then used in</p></li>
<li><p>running the actual analysis routine.</p></li>
</ol>
<p>Both of these steps must be done on command line or, alternatively, using Python.</p>
<p>There are also several independent (mostly Python-based) packages that can read and analyze Gromacs output data. Examples of such packages include <a class="reference external" href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a>, <a class="reference external" href="https://pymol.org/2/">PyMOL</a>, <a class="reference external" href="https://mdanalysis.org">MDAnalysis</a>, <a class="reference external" href="https://fatslim.github.io/">FATSLiM</a> and <a class="reference external" href="https://pybilt.readthedocs.io/en/latest/readme.html">PyBILT</a>. Importantly, <a class="reference external" href="https://mdanalysis.org">MDAnalysis</a> can also be used to analyze trajectories produced by many other simulation software including NAMD and Amber.</p>
<p>Gromacs, like most of the main simulation software, can be run on serial, parallel and GPU  systems. For parallelization, it supports MPI and OpenMP and parallelization across multiple GPUs. Both NVIDIA’s <a class="reference external" href="https://en.wikipedia.org/wiki/CUDA">CUDA</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/OpenCL">OpenCL</a> are supported but former offers much better performance. There are a few consequences:</p>
<ul class="simple">
<li><p>If you have a multicore laptop or desktop, you can run parallel simulations even on your own computer.</p></li>
<li><p>If you have an NVIDIA GPU, you can use it to run Gromacs simulations <em>provided</em> you are running Linux. The ability of being able to use GPUs from WSL2 is being added but it is not yet (Dec. 2020) generally available. This is also important for tasks other than molecular simulations as GPU acceleration is available for, for example, the <a class="reference external" href="https://www.tensorflow.org/">Tensorflow</a> package for machine learning.</p></li>
</ul>
</div>
<div class="section" id="quantum-mechanical-molecular-mechanics-calculations-qm-mm">
<h2>Quantum mechanical / Molecular Mechanics calculations (QM/MM)<a class="headerlink" href="#quantum-mechanical-molecular-mechanics-calculations-qm-mm" title="Permalink to this headline">¶</a></h2>
<!--

````{figure}
:alt: QMMM
````

-->
<p>Gromacs also allows for hybrid <a class="reference external" href="https://en.wikipedia.org/wiki/QM/MM">QM/MM simulations</a>: In QM/MM, most of the simulation is done at the classical level, but a small part of the system (that is, a subsystem) is handled quantum mechanically. This requires coupling Gromacs with a quantum mechanical simulation package. At this time Gromacs has interfaces at least with <a class="reference external" href="https://www.cpmd.org/">CPMD</a>, Gaussian and <a class="reference external" href="http://www.cfs.dl.ac.uk/">GAMESS-UK</a>. Support is also planned for <a class="reference external" href="https://www.cp2k.org/">CP2K</a> (in 2021).</p>
<!-- 
The package includes a fully automated topology builder for proteins,
even multimeric structures.
-->
</div>
<div class="section" id="the-grompp-preprocessor">
<h2>The <code class="docutils literal notranslate"><span class="pre">grompp</span></code> preprocessor<a class="headerlink" href="#the-grompp-preprocessor" title="Permalink to this headline">¶</a></h2>
<p>One particular feature of Gromacs’ is the <a class="reference external" href="https://manual.gromacs.org/current/onlinehelp/gmx-grompp.html"><code class="docutils literal notranslate"><span class="pre">grompp</span></code> preprocessor</a>. <code class="docutils literal notranslate"><span class="pre">grompp</span></code> is used at several stages of building a simulation, but in general it reads the file describing molecular topologies (<code class="docutils literal notranslate"><span class="pre">.top</span></code>), it checks the validity and consistency of files and builds a binary run input file (<code class="docutils literal notranslate"><span class="pre">.tpr</span></code>) that is used for execution of the MD simulation.</p>
<p>Technically, <code class="docutils literal notranslate"><span class="pre">grompp</span></code> is serial preprocessor and it is used to perform several tasks <em>prior</em> to the actual simulation. In particular, <code class="docutils literal notranslate"><span class="pre">grommp</span></code> is used for the following tasks:</p>
<p>– To read the molecular topology file (<code class="docutils literal notranslate"><span class="pre">.top</span></code>). Then, <code class="docutils literal notranslate"><span class="pre">grompp</span></code> checks its validity, and (if everything is ok), it expands the topology from a molecular to an atomic description. That is, it builds the molecules using the atomic data.
– To reads the coordinate file. Additionally, it can generate velocities from a Maxwellian
distribution if requested in the input (<code class="docutils literal notranslate"><span class="pre">.mdp</span></code>) file.
– To reads parameters (from the <code class="docutils literal notranslate"><span class="pre">.mdp</span></code> file). This includes the number of MD time steps, time step, cut-off and so on.</p>
<ul class="simple">
<li><p>To use some of Gromacs’ utility programs. This includes generating the simulation box, addion ions, processing Protein Databank (<code class="docutils literal notranslate"><span class="pre">.pdb</span></code>) files</p></li>
</ul>
<!--
• Parallel MD and energy minimizing program mdrun.
– Performs simulation or minimization.
- Several analysis tools g ..., ngmx.
- Utility programs pdb2gmx, genbox, genion, ....
– Produces a binary file as the sole input for the MD program. This is is very convenient as it makes starting Gromacs very easy. 
-->
</div>
<div class="section" id="additional-features">
<h2>Additional features<a class="headerlink" href="#additional-features" title="Permalink to this headline">¶</a></h2>
<p>It is impossible to give a brief yet comprehensive description of the many features that Gromacs offers. Below, some of the common ones are listed as examples. The listed features are chosen based on what will be encountered in the simulations during this course.</p>
<p>For integration of Newton’s equations of motion, there are a few options most notably the <a class="reference external" href="https://en.wikipedia.org/wiki/Verlet_integration#Velocity_Verlet">velocity-Verlet</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/Leapfrog_integration">leap-frog</a> methods. For energy minimization, the main options are the <a class="reference external" href="https://en.wikipedia.org/wiki/Method_of_steepest_descent">method of steepest descents</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">conjugate gradient</a> method. There is an often overlooked major difference between integration of the equations of motion and energy minimization: <em>Integration</em> is the propagation of the equations of motion in time with a time step given in terms of real time. Thus, it involves updates of the particles’ positions and velocities. <em>Energy minimization</em> using <a class="reference external" href="https://en.wikipedia.org/wiki/Method_of_steepest_descent">steepest descents</a> or the <a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">conjugate gradient</a> method is a mathematical (deterministic) optimization process that involves minimization of the potential energy, that is, only positions are needed. Second, even though ones gives a number of steps for the optimization process, the number of steps does not correspond to physical time but only gives an upper limit for the number of steps to be taken in case the process doesn’t converge earlier. We will not discuss these methods in detail here, but it is important to understand that <em>optimization</em> using these methods does not involve time or velocities, it is simply minimization of the potential energy. This is a general feature of these methods are not specific to Gromacs or any other simulation/modeling package.</p>
<p>For thermostats, Gromacs offers the choices of the <a class="reference external" href="https://en.wikipedia.org/wiki/Berendsen_thermostat">Berendsen</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Nos%C3%A9%E2%80%93Hoover_thermostat">Nosé-Hoover</a>, Nosé-Hoover chain<a class="bibtex reference internal" href="#martyna1992" id="id2">[4]</a> (with some restrictions), v-rescale<a class="bibtex reference internal" href="#bussi2007a" id="id3">[3]</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Andersen_thermostat">Andersen</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Langevin_dynamics">Langevin</a> (called stochastic dynamics in Gromacs) thermostats. Currently, the <a class="reference external" href="https://en.wikipedia.org/wiki/Dissipative_particle_dynamics">Dissipative Particle Dynamics</a> (DPD) thermostat is not available (it is available in LAMMPS). The choice of thermostat depends on the system and properties of interest, but the Nosé-Hoover and v-rescale are the most common and recommended choices. For colloidal systems, Gromacs has also <a class="reference external" href="https://en.wikipedia.org/wiki/Brownian_dynamics">Brownian dynamics</a>. As for periodic boundary conditions, Gromacs has three options, <a class="reference external" href="https://en.wikipedia.org/wiki/Cuboid">cuboid</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Rhombic_dodecahedron">rhombic dodecahedron</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Truncated_octahedron">truncated octahedron</a>.</p>
<!--

````{figure} Space filling structures
````

-->
<p>Why those ones for periodic boundary conditions? The reason is simple: When using periodic boundaries, the simulation cell must have a structure that it is <a class="reference external" href="https://en.wikipedia.org/wiki/Space-filling_polyhedron">space filling</a>. If the simulation uses closed boundaries, any structure is fine (as long as it is available in the code or if one can code it).</p>
<p>For barostats, Gromacs has the Berendsen<a class="bibtex reference internal" href="#berendsen1984" id="id4">[2]</a>, Parrinello-Rahman<a class="bibtex reference internal" href="#parrinello1981a" id="id5">[7]</a> and Martyna-Tuckerman-Tobias-Klein<a class="bibtex reference internal" href="#martyna1994" id="id6">[5]</a><a class="bibtex reference internal" href="#martyna1996" id="id7">[6]</a> (with some restrictions) as the possible options. The two latter ones are the recommended options, but the Berendsen method is often useful during the pre-equilibration of the system.</p>
<p>For computing the long-range electrostatic interactions, one has the choices of simple cutoff (not recommended), reaction-field, plain <a class="reference external" href="https://en.wikipedia.org/wiki/Ewald_summation">Ewald summation</a>, the particle-particle particle-mesh (P3M) and the particle mesh Ewald sum (PME). The last one is the most common choice. Gromacs has also the option to use a modified PME for systems that are not fully periodic. The most additions (not in the main version at this time) is the <a class="reference external" href="https://en.wikipedia.org/wiki/Fast_multipole_method">Fast Multipole Method</a> (FMM) of Greengard and Rokhlin.</p>
<!--
• Shell molecular dynamics accounts for polarizability in the simulation.
• Non-equilibrium molecular dynamics options, including accelerations on
arbitrary groups of atoms and electric fields.
-->
<div class="section" id="free-energy-calculations">
<h3>Free energy calculations<a class="headerlink" href="#free-energy-calculations" title="Permalink to this headline">¶</a></h3>
<p>Gromacs also supports free energy calculations using the slow growth method, <a class="reference external" href="https://en.wikipedia.org/wiki/Thermodynamic_integration">thermodynamic integration</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Umbrella_sampling">umbrella sampling</a>.  <a class="reference external" href="https://en.wikipedia.org/wiki/Metadynamics">Metadynamics</a> with its many variants can be used using the <a class="reference external" href="https://www.plumed.org/">PLUMED-plugin</a>. <a class="reference external" href="https://www.plumed.org/">PLUMED</a> is not restricted to Gromacs but it can be used with many other packages including LAMMPS, Amber, CP2K (quantum) and so on. <a class="reference external" href="https://www.plumed.org/">PLUMED</a> was originally introduced in 2009 and its current version PLUMED2 in 214.</p>
</div>
</div>
<div class="section" id="gromacs-unit-system">
<h2>Gromacs unit system<a class="headerlink" href="#gromacs-unit-system" title="Permalink to this headline">¶</a></h2>
<p>Every MD software has its own convention to handle units. When switching between, for example, Gromacs, NAMD, LAMMPS or others, one should pay attention to the units used in each of the software. Another circumstance in which the importance of the unit convention should be give special attention is when different analysis packages such as <a class="reference external" href="https://mdanalysis.org/">MDAnalysis</a> or such are used. They may (and often do) use different convention(s).</p>
<p>Gromacs uses the following five base units:</p>
<!--
````{panels}
   :column: col-lg-12 p-2

-->   
<!-- table-bordered, -->
<table class="table-hover table" id="gromacs-units">
<caption><span class="caption-text">Gromacs’ five base units,</span><a class="headerlink" href="#gromacs-units" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Quantity:</strong></p></th>
<th class="head"><p><strong>Unit:</strong></p></th>
<th class="head"><p><strong>Numerical value:</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>length:</p></td>
<td><p>nanometers</p></td>
<td><p>10<span class="math notranslate nohighlight">\(^{-9}\)</span> m</p></td>
</tr>
<tr class="row-odd"><td><p>time:</p></td>
<td><p>picoseconds</p></td>
<td><p>10<span class="math notranslate nohighlight">\(^{-12}\)</span> s</p></td>
</tr>
<tr class="row-even"><td><p>temperature:</p></td>
<td><p>kelvin</p></td>
<td><p>absolute scale: 0 K = -273.15 <span class="math notranslate nohighlight">\(^\circ\)</span>C</p></td>
</tr>
<tr class="row-odd"><td><p>mass:</p></td>
<td><p>u (atomic unit)</p></td>
<td><p><span class="math notranslate nohighlight">\(\approx\)</span> 1.661  <span class="math notranslate nohighlight">\(\times\)</span> 10<span class="math notranslate nohighlight">\(^{-27}\)</span> kg</p></td>
</tr>
<tr class="row-even"><td><p>charge</p></td>
<td><p>elementary charge (e)</p></td>
<td><p><span class="math notranslate nohighlight">\(\approx\)</span> 1.602 <span class="math notranslate nohighlight">\(\times\)</span> 10<span class="math notranslate nohighlight">\(^{-19}\)</span> C</p></td>
</tr>
</tbody>
</table>
<!--
````
-->
<p>This gives the following derived units:</p>
<!-- table-bordered, -->
<table class="table table-hover" id="id8">
<caption><span class="caption-text">Gromacs’ derived units</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Quantity:</strong></p></th>
<th class="head"><p><strong>Unit:</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>energy:</p></td>
<td><p>kJ/mol</p></td>
</tr>
<tr class="row-odd"><td><p>force:</p></td>
<td><p>kJ/(mol <span class="math notranslate nohighlight">\(\times\)</span> nm )</p></td>
</tr>
<tr class="row-even"><td><p>velocity:</p></td>
<td><p>nm/ps</p></td>
</tr>
<tr class="row-odd"><td><p>density:</p></td>
<td><p>g/mol</p></td>
</tr>
<tr class="row-even"><td><p>pressure:</p></td>
<td><p>bar</p></td>
</tr>
<tr class="row-odd"><td><p>dipole moment:</p></td>
<td><p>e <span class="math notranslate nohighlight">\(\times\)</span> nm</p></td>
</tr>
<tr class="row-even"><td><p>electric field:</p></td>
<td><p>kJ/( mol <span class="math notranslate nohighlight">\(\times\)</span> nm <span class="math notranslate nohighlight">\(\times\)</span> e)</p></td>
</tr>
<tr class="row-odd"><td><p>electric potential:</p></td>
<td><p>kJ/( mol <span class="math notranslate nohighlight">\(\times\)</span> e)</p></td>
</tr>
<tr class="row-even"><td><p>compressibility:</p></td>
<td><p>bar<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<p>Files:</p>
<p>During the different stages, the coordinate/structure file (<code class="docutils literal notranslate"><span class="pre">.gro</span></code>), the topology file (.top) and the run input file (<code class="docutils literal notranslate"><span class="pre">.tpr</span></code>) get updated. If some of the stages must be re-run, it may become necessary to remove one/some of <code class="docutils literal notranslate"><span class="pre">.gro</span></code>, <code class="docutils literal notranslate"><span class="pre">.top</span></code>, <code class="docutils literal notranslate"><span class="pre">.tpr</span></code> files.</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Example of gro file<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">gro</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
### Binary files and ascii files

Data analysis output, files:

Gromacs’ data analysis routines produce `.xvg` files. They need the free software xmgrace. Or if you prefer, you can write a script to handle them with python. xmgrace is easier, though, and it can produce high quality plots in various formats including png, jpg, svg and pdf.

````{dropdown} Example of an xvg file
data here
</pre></div>
</div>
</div>
</details></div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-class/week03/gromacs-intro-0"><dl class="citation">
<dt class="bibtex label" id="bereau2014"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Tristan Bereau, Zun-Jing Wang, and Markus Deserno. More than the sum of its parts: coarse-grained peptide-lipid interactions from a simple cross-parametrization. <em>The Journal of Chemical Physics</em>, 140(11):115101, Mar 2014. <a class="reference external" href="https://doi.org/10.1063/1.4867465">doi:10.1063/1.4867465</a>.</p>
</dd>
<dt class="bibtex label" id="berendsen1984"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>H. J. C. Berendsen, J. P. M. Postma, W. F. van Gunsteren, A. DiNola, and J. R. Haak. Molecular dynamics with coupling to an external bath. <em>The Journal of Chemical Physics</em>, 81(8):3684, 1984. <a class="reference external" href="https://doi.org/10.1063/1.448118">doi:10.1063/1.448118</a>.</p>
</dd>
<dt class="bibtex label" id="bussi2007a"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Giovanni Bussi, Davide Donadio, and Michele Parrinello. Canonical sampling through velocity rescaling. <em>The Journal of Chemical Physics</em>, 126(1):014101, 2007. <a class="reference external" href="https://doi.org/10.1063/1.2408420">doi:10.1063/1.2408420</a>.</p>
</dd>
<dt class="bibtex label" id="martyna1992"><span class="brackets"><a class="fn-backref" href="#id2">4</a></span></dt>
<dd><p>Glenn J. Martyna, Michael L. Klein, and Mark Tuckerman. Nose’–hoover chains: the canonical ensemble via continuous dynamics. <em>The Journal of Chemical Physics</em>, 97(4):2635, 1992. <a class="reference external" href="https://doi.org/10.1063/1.463940">doi:10.1063/1.463940</a>.</p>
</dd>
<dt class="bibtex label" id="martyna1994"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Glenn J. Martyna, Douglas J. Tobias, and Michael L. Klein. Constant pressure molecular dynamics algorithms. <em>The Journal of Chemical Physics</em>, 101(5):4177–4189, sep 1994. <a class="reference external" href="https://doi.org/10.1063/1.467468">doi:10.1063/1.467468</a>.</p>
</dd>
<dt class="bibtex label" id="martyna1996"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><p>Glenn J. Martyna, Mark E. Tuckerman, Douglas J. Tobias, and Michael L. Klein. Explicit reversible integrators for extended systems dynamics. <em>Molecular Physics</em>, 87(5):1117–1157, apr 1996. <a class="reference external" href="https://doi.org/10.1080/00268979600100761">doi:10.1080/00268979600100761</a>.</p>
</dd>
<dt class="bibtex label" id="parrinello1981a"><span class="brackets"><a class="fn-backref" href="#id5">7</a></span></dt>
<dd><p>M. Parrinello and A. Rahman. Polymorphic transitions in single crystals: a new molecular dynamics method. <em>Journal of Applied Physics</em>, 52(12):7182–7190, dec 1981. <a class="reference external" href="https://doi.org/10.1063/1.328693">doi:10.1063/1.328693</a>.</p>
</dd>
</dl>
</p>
<!--
## Gromacs cheatsheet
-->
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "firasm/jupyterbook_course_template",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./class/week03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikko Karttunen<br/>
        
          <div class="extra_footer">
            <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>